<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>邂逅React | Mr.储</title><meta name="keywords" content="web前端"><meta name="author" content="Mr.储"><meta name="copyright" content="Mr.储"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="认识React React 中文文档1(国内社区)：https:&#x2F;&#x2F;react.docschina.org&#x2F; React 中文文档2(官方)：https:&#x2F;&#x2F;zh-hans.reactjs.org  React 概述React 是一个用于构建(动态显示)用户界面的 JavaScript 库。  React 起源于 Facebook ,并于 2013 年 5 月开源 React本身只关注界面, 其它">
<meta property="og:type" content="article">
<meta property="og:title" content="邂逅React">
<meta property="og:url" content="https://old-gang.github.io/post/d9de3b24.html">
<meta property="og:site_name" content="Mr.储">
<meta property="og:description" content="认识React React 中文文档1(国内社区)：https:&#x2F;&#x2F;react.docschina.org&#x2F; React 中文文档2(官方)：https:&#x2F;&#x2F;zh-hans.reactjs.org  React 概述React 是一个用于构建(动态显示)用户界面的 JavaScript 库。  React 起源于 Facebook ,并于 2013 年 5 月开源 React本身只关注界面, 其它">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-11-25T05:38:47.000Z">
<meta property="article:modified_time" content="2024-12-21T09:13:26.353Z">
<meta property="article:author" content="Mr.储">
<meta property="article:tag" content="web前端">
<meta name="twitter:card" content="summary"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://old-gang.github.io/post/d9de3b24"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '邂逅React',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-12-21 17:13:26'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/universe.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">20</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Mr.储</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">邂逅React</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon fas fa-history"></i><span class="post-meta-label">更新于</span><time datetime="2024-12-21T09:13:26.353Z" title="更新于 2024-12-21 17:13:26">2024-12-21</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="邂逅React"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="认识React"><a href="#认识React" class="headerlink" title="认识React"></a>认识React</h2><ul>
<li>React 中文文档1(国内社区)：<a target="_blank" rel="noopener" href="https://react.docschina.org/">https://react.docschina.org/</a></li>
<li>React 中文文档2(官方)：<a target="_blank" rel="noopener" href="https://zh-hans.reactjs.org/">https://zh-hans.reactjs.org</a></li>
</ul>
<h3 id="React-概述"><a href="#React-概述" class="headerlink" title="React 概述"></a>React 概述</h3><p>React 是一个用于<code>构建(动态显示)用户界面</code>的 JavaScript 库。</p>
<blockquote>
<p>React 起源于 <code>Facebook</code> ,并于 2013 年 5 月开源</p>
<p>React本身只关注界面, 其它如：前后台交互、路由管理、状态管理等都由其扩展插件或其它第三方插件搞定</p>
</blockquote>
<h3 id="React-三个特点"><a href="#React-三个特点" class="headerlink" title="React 三个特点"></a>React 三个特点</h3><ul>
<li>1 声明式  &#x3D;&#x3D;&gt; 命令式编程    arr.filter(item &#x3D;&gt; item.price&gt;80)<ul>
<li>利用JSX 语法来声明描述动态页面， &#x3D;&#x3D;数据更新界面自动更新&#x3D;&#x3D;</li>
<li>我们不用亲自操作DOM, 只需要更新数据, 界面就会自动更新</li>
<li>React.createElement() 是命令式</li>
</ul>
</li>
<li>2 组件化<ul>
<li>将一个较大较复杂的界面拆分成几个可复用的部分封装成多个组件， 再组合使用</li>
<li>组件可以被反复使用</li>
</ul>
</li>
<li>3 一次学习，随处编写<ul>
<li>不仅可以开发 web 应用（react-dom），还可以开发原生安卓或ios应用（react-native）</li>
</ul>
</li>
</ul>
<h3 id="React-开发的网站"><a href="#React-开发的网站" class="headerlink" title="React 开发的网站"></a>React 开发的网站</h3><ul>
<li>MDN: <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/">https://developer.mozilla.org/zh-CN/</a></li>
<li>知乎: <a target="_blank" rel="noopener" href="https://www.zhihu.com/">https://www.zhihu.com/</a></li>
<li>阿里云: <a target="_blank" rel="noopener" href="https://www.aliyun.com/">https://www.aliyun.com/</a></li>
<li>美团: <a target="_blank" rel="noopener" href="https://bj.meituan.com/">https://bj.meituan.com/</a></li>
<li>飞猪旅行: <a target="_blank" rel="noopener" href="https://www.fliggy.com/?spm=181.11358650.0.0.6718223eLhsSSU">https://www.fliggy.com/?spm=181.11358650.0.0.6718223eLhsSSU</a></li>
<li>…</li>
</ul>
<h3 id="安装VSCode插件"><a href="#安装VSCode插件" class="headerlink" title="安装VSCode插件"></a>安装VSCode插件</h3><ul>
<li>ES7+ React</li>
<li>open in browser</li>
</ul>
<h2 id="React基本使用"><a href="#React基本使用" class="headerlink" title="React基本使用"></a>React基本使用</h2><h3 id="基本使用步骤"><a href="#基本使用步骤" class="headerlink" title="基本使用步骤"></a>基本使用步骤</h3><ol>
<li><p>引入两个JS文件（ 注意引入顺序 ）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- react库, 提供<span class="title class_">React</span>对象 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../js/react.development.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;!-- react-dom库, 提供了<span class="title class_">ReactDOM</span>对象 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../js/react-dom.development.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在html定义一个根容器标签</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;root&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建react元素(类似html元素)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 返回值：React元素 </span></span><br><span class="line"><span class="comment">// 参数1：要创建的React元素名称 =》字符串</span></span><br><span class="line"><span class="comment">// 参数2：元素的属性  =》对象 &#123;id: &#x27;box&#x27;&#125; 没有属性时用 null或者&#123;&#125;</span></span><br><span class="line"><span class="comment">// 后面参数：该React元素的所有子节点 =》文本或者其他react元素</span></span><br><span class="line"><span class="keyword">const</span> element = <span class="title class_">React</span>.<span class="title function_">createElement</span>(</span><br><span class="line">  <span class="string">&#x27;h1&#x27;</span>, </span><br><span class="line">  &#123;<span class="attr">title</span>: <span class="string">&#x27;你好, React!&#x27;</span>&#125;, </span><br><span class="line">  <span class="string">&#x27;Hello React!&#x27;</span></span><br><span class="line">)</span><br><span class="line"><span class="comment">//当有多个子元素时，继续调用React.createElement</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>渲染 react 元素</p>
<blockquote>
<p>ReactDOM &#x3D;&#x3D;DOM是大写&#x3D;&#x3D;</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 渲染React元素到页面容器div中</span></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(element, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"><span class="comment">//第一个参数：react元素</span></span><br><span class="line"><span class="comment">//第二个参数：放置容器元素</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="特殊属性"><a href="#特殊属性" class="headerlink" title="特殊属性"></a>特殊属性</h3><ul>
<li>class  &#x3D;&#x3D;》 className</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> element = <span class="title class_">React</span>.<span class="title function_">createElement</span>(</span><br><span class="line">  <span class="string">&#x27;h1&#x27;</span>, </span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&#x27;你好, React!&#x27;</span>,</span><br><span class="line">    <span class="attr">className</span>: <span class="string">&#x27;active&#x27;</span></span><br><span class="line">  &#125;, </span><br><span class="line">  <span class="string">&#x27;Hello React!&#x27;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h3 id="再来个复杂点的"><a href="#再来个复杂点的" class="headerlink" title="再来个复杂点的"></a>再来个复杂点的</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> title = <span class="string">&#x27;北京疫情&#x27;</span></span><br><span class="line"><span class="keyword">const</span> content = <span class="string">&#x27;北京这段时间疫情还在持续中...&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> vDom = <span class="title class_">React</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">null</span>, </span><br><span class="line">  <span class="title class_">React</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;h2&#x27;</span>, &#123;title&#125;, <span class="string">&#x27;你关注的北京疫情&#x27;</span>),</span><br><span class="line">  <span class="title class_">React</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;p&#x27;</span>, <span class="literal">null</span>, content)</span><br><span class="line">)</span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(vDom, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root2&#x27;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="理解-React-元素"><a href="#理解-React-元素" class="headerlink" title="理解 React 元素"></a>理解 React 元素</h3><ol>
<li><p>也称<code>虚拟 DOM</code> (virtual DOM) 或<code>虚拟节点</code>(virtual Node)</p>
</li>
<li><p>它就是一个普通的 JS 对象, 它不是真实 DOM 元素对象</p>
<p>虚拟 DOM: 属性比较少  &#x3D;&#x3D;&gt; <code>较轻</code>的对象</p>
<p>真实 DOM: 属性特别多  &#x3D;&#x3D;&gt; <code>较重</code>的对象</p>
</li>
<li><p>但它有一些自己的特点</p>
<p>虚拟 DOM 可以转换为对应的真实 DOM  &#x3D;&gt; ReactDOM.render方法将虚拟DOM转换为真实DOM再插入页面</p>
<p>虚拟 DOM 对象包含了对应的真实 DOM 的关键信息属性</p>
<p>​    标签名 &#x3D;&gt; type: “h1”</p>
<p>​    标签属性 &#x3D;&gt; props: {title: ‘你好, React!’}</p>
<p>​    子节点 &#x3D;&gt; props: {children: ‘Hello React!’}</p>
</li>
</ol>
<h2 id="JSX"><a href="#JSX" class="headerlink" title="JSX"></a>JSX</h2><h3 id="基本理解和使用"><a href="#基本理解和使用" class="headerlink" title="基本理解和使用"></a>基本理解和使用</h3><blockquote>
<p><code>问题</code>:  React.createElement()写起来太复杂了</p>
<p><code>解决</code>:  推荐使用更加简洁的<strong>JSX</strong></p>
<p><strong>JSX</strong> 是一种JS 的扩展语法, 用来快速创建 React 元素(虚拟DOM&#x2F;虚拟节点)</p>
<p>形式上像HTML标签&#x2F;任意其它标签, 且标签内部是可以套JS代码的</p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> h1 = <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">className</span>=<span class="string">&quot;active&quot;</span>&gt;</span>哈哈哈<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>   </span><br></pre></td></tr></table></figure>

<blockquote>
<p>浏览器并不认识 JSX 所以需要引入babel将jsx 编译成React.createElement的形式</p>
<p>babel编译 JSX 语法的包为：@babel&#x2F;preset-react</p>
<p>运行时编译可以直接使用babel的完整包：babel.js</p>
<p>线上测试: <a target="_blank" rel="noopener" href="https://www.babeljs.cn/">https://www.babeljs.cn/</a></p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 必须引入编译jsx的babel库 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../js/babel.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 必须声明type为text/babel, 告诉babel对内部的代码进行jsx的编译 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/babel&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">	<span class="comment">// 创建React元素 (也称为虚拟DOM 或 虚拟节点)</span></span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">const</span> vDom = <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">title</span>=<span class="string">&quot;你好, React2!&quot;</span> <span class="attr">className</span>=<span class="string">&quot;active&quot;</span>&gt;</span>Hello React2!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 渲染React元素到页面容器div中</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(vDom, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意:</p>
<p>​	必须有结束标签<br>​	整个只能有一个根标签<br>​	单标签必须自闭合</p>
</blockquote>
<h3 id="JSX中使用-JS-表达式"><a href="#JSX中使用-JS-表达式" class="headerlink" title="JSX中使用 JS 表达式"></a>JSX中使用 JS 表达式</h3><ul>
<li>JSX中使用JS表达式的语法：<code>&#123;js表达式&#125;</code></li>
<li>作用: <code>指定动态的属性值和标签体文本</code></li>
</ul>
<blockquote>
<ol>
<li><p>可以是&#x3D;&#x3D;js的表达式&#x3D;&#x3D;, 不能是js的语句</p>
</li>
<li><p>可以是任意基本类型数据值, 但null、undefined和布尔值没有任何显示</p>
</li>
<li><p>可以是一个js数组, 但不能是js对象</p>
</li>
</ol>
<ul>
<li>数组中的每一个元素会被循环遍历，渲染到页面中</li>
</ul>
<ol>
<li>可以是react元素对象</li>
<li>style属性值必须是一个包含样式的js对象 <code>style=&#123;&#123;color:red&#125;&#125;</code></li>
</ol>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> title = <span class="string">&#x27;I Like You&#x27;</span></span><br><span class="line"><span class="keyword">const</span> vNode = (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h3</span> <span class="attr">name</span>=<span class="string">&#123;title&#125;</span>&gt;</span>&#123;title.toUpperCase()&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;3&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;null&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;undefined&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;true&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;&#x27;true&#x27;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;React.createElement(&#x27;div&#x27;, null, &#x27;atguigu&#x27;)&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;[1, &#x27;abc&#x27;, 3]&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h3</span> <span class="attr">title</span>=<span class="string">&#123;title&#125;</span> <span class="attr">id</span>=<span class="string">&quot;name&quot;</span> <span class="attr">className</span>=<span class="string">&quot;ative&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;color:</span> &#x27;<span class="attr">red</span>&#x27;&#125;&#125;&gt;</span><span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &#123;/* <span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;&#123;a: 1&#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span> */&#125; </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>注意：</p>
<p><font color="red">JSX嵌入变量作为子元素</font></p>
<ul>
<li>情况一：当变量是Number、String、Array类型时，可以直接显示</li>
<li>情况二：当变量是null、undefined、Boolean类型时，内容为空；<ul>
<li>如果希望可以显示null、undefined、Boolean，那么需要转成字符串；</li>
<li>转换的方式有很多，比如toString方法、和空字符串拼接，String(变量)等方式；</li>
</ul>
</li>
<li>情况三：Object对象类型不能作为子元素（not valid as a React child）</li>
</ul>
<h2 id="条件渲染"><a href="#条件渲染" class="headerlink" title="条件渲染"></a>条件渲染</h2><h3 id="if…else"><a href="#if…else" class="headerlink" title="if…else"></a>if…else</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> vDom</span><br><span class="line"><span class="keyword">if</span> (isLoading) &#123;</span><br><span class="line">  vDom = <span class="language-xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>正在加载中...<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  vDom = <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>加载完成啦!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"> <span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(vDom, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h3 id="三元表达式"><a href="#三元表达式" class="headerlink" title="三元表达式"></a>三元表达式</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> vDom = isLoading ? <span class="language-xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>正在加载中2...<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span> : <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>加载完成啦2!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(vDom, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h3 id="amp-amp"><a href="#amp-amp" class="headerlink" title="&amp;&amp;"></a>&amp;&amp;</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> vDom = isLoading &amp;&amp; <span class="language-xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>正在加载中3...<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(vDom, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"><span class="comment">// 注意: 只适用于只在一种情况下才有界面的情况</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>复习增强:</p>
<p>整个表达式的值 &#x3D; 表达式1 &amp;&amp; 表达式2</p>
<p>​    如果表达式1对应的boolean为true, 结果就为表达式2的值</p>
<p>​    如果表达式1对应的boolean为false, 结果就为表达式1的值</p>
<p>表达式1 || 表达式1</p>
<p>​    如果表达式1对应的boolean为true, 结果就是表达式1的值</p>
<p>​    如果表达式1对应的boolean为false, 结果就为表达式2的值</p>
</blockquote>
<h2 id="列表渲染"><a href="#列表渲染" class="headerlink" title="列表渲染"></a>列表渲染</h2><ul>
<li>react中可以将数组中的元素依次渲染到页面上</li>
<li>可以直接往数组中存储react元素</li>
<li>推荐使用数组的 map 方法</li>
<li>注意：必须给列表项添加唯一的 key 属性, 推荐使用id作为key, 尽量不要用index作为key</li>
</ul>
<blockquote>
<p>需求: 根据下面的数组显示列表</p>
<p>const courses &#x3D; [<br>{id: 1, name: ‘React’},<br>{id: 3, name: ‘Vue’},<br>{id: 5, name: ‘小程序’}<br>]</p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> courses = [</span><br><span class="line">  &#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;React&#x27;</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">id</span>: <span class="number">3</span>, <span class="attr">name</span>: <span class="string">&#x27;Vue&#x27;</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">id</span>: <span class="number">5</span>, <span class="attr">name</span>: <span class="string">&#x27;小程序&#x27;</span>&#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> vDom = (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>前端框架课程列表<span class="tag">&lt;/<span class="name">h2</span>&gt;</span>  </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;courses.map(c =&gt; <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;c.id&#125;</span>&gt;</span>&#123;c.name&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span>)&#125;  </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(vDom, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h2 id="样式处理"><a href="#样式处理" class="headerlink" title="样式处理"></a>样式处理</h2><h3 id="行内样式"><a href="#行内样式" class="headerlink" title="行内样式"></a>行内样式</h3><ul>
<li>样式属性名使用小驼峰命名法</li>
<li>如果样式是数值，可以省略单位</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;h2 style=&#123;&#123;<span class="attr">color</span>: <span class="string">&#x27;red&#x27;</span>, <span class="attr">fontSize</span>: <span class="number">30</span>&#125;&#125;&gt;<span class="title class_">React</span> style&lt;/h2&gt;</span><br></pre></td></tr></table></figure>

<h3 id="类名"><a href="#类名" class="headerlink" title="类名"></a>类名</h3><ul>
<li>必须用className, 不能用class</li>
<li>推荐, 效率更高些</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;h2 className=<span class="string">&quot;title&quot;</span>&gt;<span class="title class_">React</span> <span class="keyword">class</span>&lt;/h2&gt;</span><br></pre></td></tr></table></figure>

<h2 id="事件处理"><a href="#事件处理" class="headerlink" title="事件处理"></a>事件处理</h2><h3 id="绑定事件"><a href="#绑定事件" class="headerlink" title="绑定事件"></a>绑定事件</h3><p>React 元素的事件处理和 DOM 元素的很相似，但是有一点语法上的不同：</p>
<ul>
<li>React 事件的命名采用小驼峰式（camelCase），而不是纯小写。比如：onClick、onFocus 、onMouseEnter</li>
<li>使用 JSX 语法时你需要传入一个函数作为事件处理函数，而不是一个字符串</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> div = <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">onClick</span>=<span class="string">&#123;事件处理函数&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h3 id="事件对象"><a href="#事件对象" class="headerlink" title="事件对象"></a>事件对象</h3><p>React 根据 <a target="_blank" rel="noopener" href="https://www.w3.org/TR/DOM-Level-3-Events/">W3C 规范</a>来自定义的合成事件, 与原生事件不完全相同</p>
<ul>
<li><p>处理好了浏览器的兼容性问题</p>
</li>
<li><p>阻止事件默认行为，不能使用return false,  必须要调用: event.preventDefault()</p>
</li>
<li><p>有自己特有的属性, 比如: nativeEvent –原生事件对象</p>
</li>
<li><p>&lt;input&gt;的change监听在输入过程中触发， 而原生是在失去焦点才触发</p>
<ul>
<li>原理：内部绑定的是原生input事件</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">handleClick1</span>(<span class="params">event</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(event)</span><br><span class="line">  <span class="title function_">alert</span>(event.<span class="property">target</span>.<span class="property">innerHTML</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleClick2</span> = (<span class="params">event</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> isOdd = <span class="title class_">Date</span>.<span class="title function_">now</span>()%<span class="number">2</span>===<span class="number">1</span></span><br><span class="line">  <span class="title function_">alert</span>(isOdd)</span><br><span class="line">  <span class="keyword">if</span> (!isOdd) &#123;</span><br><span class="line">    <span class="comment">// return false // 不起作用</span></span><br><span class="line">    event.<span class="title function_">preventDefault</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> vDom = <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleClick1&#125;</span>&gt;</span>点击提示按钮文本<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://www.baidu.com&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;handleClick2&#125;</span>&gt;</span>奇数才去百度<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(vDom, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h2 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h2><ul>
<li>需求：实现评论列表功能<ul>
<li>如果有评论数据，就展示列表结构 li（ 列表渲染 ）要包含a标签<ul>
<li>name 表示评论人，渲染 h3</li>
<li>content 表示评论内容，渲染 p</li>
</ul>
</li>
<li>如果没有评论数据，就展示一个 h1 标签，内容为： 暂无评论！</li>
<li>用户名的字体25px, 内容的字体20px</li>
<li>点击内容区域提示它发表的时间</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> list = [</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;jack&#x27;</span>, <span class="attr">content</span>: <span class="string">&#x27;rose, you jump i jump&#x27;</span>, <span class="attr">time</span>: <span class="string">&#x27;03:21&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;rose&#x27;</span>, <span class="attr">content</span>: <span class="string">&#x27;jack, you see you, one day day&#x27;</span>, <span class="attr">time</span>: <span class="string">&#x27;03:22&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">name</span>: <span class="string">&#x27;tom&#x27;</span>, <span class="attr">content</span>: <span class="string">&#x27;jack,。。。。。&#x27;</span>, <span class="attr">time</span>: <span class="string">&#x27;03:23&#x27;</span> &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h2 id="React的组件"><a href="#React的组件" class="headerlink" title="React的组件"></a>React的组件</h2><p>组件允许你将 UI 拆分为独立可复用的代码片段，包括JS&#x2F;CSS&#x2F;IMG等。</p>
<p>组件从概念上类似于 JavaScript 函数。它接收参数（即 “<strong>props</strong>”），内部可以有自己的数据（即 “<strong>state</strong>”），并返回用于描述页面展示的 React 元素。</p>
<p><strong>一个React应用就是由一个个的React组件组成的</strong></p>
<h2 id="快速创建React项目"><a href="#快速创建React项目" class="headerlink" title="快速创建React项目"></a>快速创建React项目</h2><h3 id="react脚手架使用"><a href="#react脚手架使用" class="headerlink" title="react脚手架使用"></a>react脚手架使用</h3><blockquote>
<p>问题:  JSX 转 JS 和 ES6 转 ES5 语法运行时编译太慢了<br>解决: 利用 Webpack 进行打包处理</p>
<p>问题: webpack打包环境搭建太麻烦, 且没有质量保证, 效率低<br>解决: 使用官方提供的<code>脚手架</code>工具<br>搭建好了webpack打包环境<br>项目的目录结构</p>
</blockquote>
<h3 id="创建React项目"><a href="#创建React项目" class="headerlink" title="创建React项目"></a>创建React项目</h3><p>使用 create-react-app:</p>
<ol>
<li>下载  npm i create-react-app -g</li>
<li>创建项目命令: <code>create-react-app 项目名称</code></li>
</ol>
<blockquote>
<p>用yarn创建react脚手架</p>
<p><code>yarn create react-app 项目名称</code></p>
</blockquote>
<p>也可以利用 npx 来下载 create-react-app 并创建项目</p>
<p>命令: <code>npx create-react-app 项目名称</code></p>
<p>npx 做的事情:</p>
<ol>
<li>先全局下载 create-react-app</li>
<li>执行 create-react-app 命令, 创建 react 项目</li>
<li>自动将 create-react-app 从全局中删除掉</li>
</ol>
<h3 id="从V18降级到V17的版本"><a href="#从V18降级到V17的版本" class="headerlink" title="从V18降级到V17的版本"></a>从V18降级到V17的版本</h3><p>最新的脚手架默认使用的是最新的 React18 的版本, 而这个版本是最近才出稳定版, 企业项目还未开始使用</p>
<p>如何降级到V17的最新版呢?</p>
<ol>
<li><p>重新下载 react 和 react-dom, 并指定17的版本</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i react@17 react-dom@17</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改入口JS的实现</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="安装chrome调试工具"><a href="#安装chrome调试工具" class="headerlink" title="安装chrome调试工具"></a>安装chrome调试工具</h3><blockquote>
<p>问题: 一旦开始进行组件化的应用开发, 我们需要查看应用中组件组成和各个组件的相关数据(props&#x2F;state)</p>
<p>解决: 使用React的chrome调试工具, <code>React Developer Tools</code></p>
</blockquote>
<ul>
<li>方式一: chrome应用商品搜索 <code>React</code>, 下载安装<code>React Developer Tools</code></li>
<li>问题: 需要使用翻墙工具</li>
<li>方式二: 使用本地的安装包<ul>
<li>进入<strong>扩展程序列表</strong></li>
<li>打开 <strong>开发者模式</strong></li>
<li>将<strong>安装包的文件夹</strong>拖入扩展程序列表界面, 直接安装</li>
</ul>
</li>
<li>测试<ul>
<li>访问react项目, 插件图标会亮</li>
<li>多了调试选项: Components</li>
</ul>
</li>
</ul>
<h2 id="创建组件的两种方式"><a href="#创建组件的两种方式" class="headerlink" title="创建组件的两种方式"></a>创建组件的两种方式</h2><h3 id="函数组件"><a href="#函数组件" class="headerlink" title="函数组件"></a>函数组件</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// return null</span></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>App<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数名就是组件名</span></span><br><span class="line"><span class="title class_">ReactDom</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>)) </span><br></pre></td></tr></table></figure>

<blockquote>
<ol>
<li><p>组件名首字母必须大写. 因为react以此来区分组件元素&#x2F;标签 和 一般元素&#x2F;标签</p>
</li>
<li><p>组件内部如果有多个标签,必须使用一个根标签包裹.只能有一个根标签</p>
</li>
<li><p>必须有返回值.返回的内容就是组件呈现的结构, 如果返回值为 null，表示不渲染任何内容</p>
</li>
<li><p>会在组件标签渲染时调用, 但不会产生实例对象,  不能有状态</p>
</li>
</ol>
</blockquote>
<blockquote>
<p>注意: 后面我们会讲如何在函数组件中定义状态 &#x3D;&#x3D;&gt; hooks语法</p>
</blockquote>
<h3 id="类组件"><a href="#类组件" class="headerlink" title="类组件"></a>类组件</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>App Component<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDom</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br></pre></td></tr></table></figure>

<blockquote>
<ol>
<li><p>组件名首字母必须大写.</p>
</li>
<li><p>组件内部如果有多个标签,必须使用一个根标签包裹.只能有一个根标签</p>
</li>
<li><p>类组件应该继承 React.Component 父类，从而可以使用父类中提供的方法或属性</p>
</li>
<li><p>类组件中必须要声明一个render函数, reander返回组件代表组件界面的虚拟DOM元素</p>
</li>
<li><p>会在组件标签渲染时调用, 产生实例对象,  可以有状态</p>
</li>
</ol>
</blockquote>
<h2 id="类组件的状态-state"><a href="#类组件的状态-state" class="headerlink" title="类组件的状态 state"></a>类组件的状态 state</h2><p>函数组件又叫做无状态组件(不产生实例)，类组件又叫做有状态组件(有实例)</p>
<p>状态（state）即数据</p>
<p>函数组件没有state, 只能根据外部传入的数据（props）动态渲染</p>
<p>类组件有自己的state数据，<strong>一旦更新state数据， 界面就会自动更新</strong></p>
<h3 id="state的基本使用"><a href="#state的基本使用" class="headerlink" title="state的基本使用"></a>state的基本使用</h3><ul>
<li>状态（state）即数据，是组件内部的私有数据，只能在组件内部使用</li>
<li>组件对象的state属性<ul>
<li><p>属性值为对象, 可以在state对象中保存多个数据</p>
</li>
<li><p>初始化state</p>
<ul>
<li><p>构造器中: this.state &#x3D; {xxx: 2}</p>
</li>
<li><p>类体中: <code>state = &#123;&#125;</code></p>
</li>
</ul>
</li>
<li><p>读取state数据</p>
<ul>
<li><code>this.state.xxx</code></li>
</ul>
</li>
<li><p>更新state数据</p>
<ul>
<li>不能直接更新state数据</li>
<li>必须 this.setState({ 要修改的属性数据 })</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>类组件什么时候写constructor(){} ?</p>
<ul>
<li>子类继承父类时，有父类没有的属性需要写构造器，写了构造器，就必须在最开始写super</li>
<li>初始化状态，(直接定义状态即可)</li>
<li>为事件处理函数绑定实例 ，解决this丢失的问题 (使用赋值语句，加箭头函数的形式)</li>
</ul>
<p>如果不在类的实例身上使用this.props时，写类组件都可以不写构造器 !!!</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">StateTest</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* constructor () &#123;</span></span><br><span class="line"><span class="comment">    super() // 必须调用super()</span></span><br><span class="line"><span class="comment">    // 初始化state</span></span><br><span class="line"><span class="comment">    this.state = &#123;</span></span><br><span class="line"><span class="comment">      count: 0,</span></span><br><span class="line"><span class="comment">      xxx: &#x27;abc&#x27;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">  &#125; */</span></span><br><span class="line">  <span class="comment">// 初始化状态(简洁语法)</span></span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">xxx</span>: <span class="string">&#x27;abc&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="comment">// 读取state数据</span></span><br><span class="line">    <span class="keyword">const</span> &#123;count&#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">      // 直接更新状态数据 =&gt; 界面不会自动更新  不可用</span></span><br><span class="line"><span class="language-xml">      // this.state.count = count + 1</span></span><br><span class="line"><span class="language-xml">      </span></span><br><span class="line"><span class="language-xml">      // 通过setState()更新state =&gt; 界面会自动更新</span></span><br><span class="line"><span class="language-xml">      this.setState(&#123;</span></span><br><span class="line"><span class="language-xml">        count: count + 1</span></span><br><span class="line"><span class="language-xml">      &#125;)</span></span><br><span class="line"><span class="language-xml">    &#125;&#125;&gt;点击的次数: &#123;count&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="事件回调this问题"><a href="#事件回调this问题" class="headerlink" title="事件回调this问题"></a>事件回调this问题</h3><p>为了提高代码的性能和阅读性,最好把事件处理函数定义在结构的外面.</p>
<p>但是这样就带来了this指向的问题:</p>
<blockquote>
<p>问题: 类中定义的事件回调方法中this是undefined, 无法更新state</p>
<p>原因: 事件回调都不是组件对象调用的, 都是事件触发后,直接调用的,<br>class中所有方法都使用严格模式, 所以方法中的this就是undefined</p>
</blockquote>
<ul>
<li><p>基础代码：组件的虚拟DOM</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>当前count为: 0<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">button</span>&gt;</span>点击报错, 有this问题<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">button</span>&gt;</span>解决办法1 - 包裹箭头函数<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">button</span>&gt;</span>解决办法2 - bind绑定this <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">button</span>&gt;</span>解决办法3 - 箭头函数<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>解决办法1 - 包裹箭头函数(常用)<br>原因: render中的this是组件对象, 处理函数是我们通过组件对象来调用的</p>
<p>解决办法2 - bind绑定this<br>原因: 构造器中的this是组件对象, 将处理函数通过bind绑定为了组件对象</p>
<p>解决办法3 - 箭头函数<br>原理: 利用bind给事件回调绑定this为组件对象(render中的this)(常用)</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">EventThis</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span> () &#123; <span class="comment">// 构造器中的this是组件对象</span></span><br><span class="line">    <span class="variable language_">super</span>()</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">    this.handle4 = () =&gt;  &#123;</span></span><br><span class="line"><span class="comment">      console.log(this)</span></span><br><span class="line"><span class="comment">      this.setState(&#123;</span></span><br><span class="line"><span class="comment">        count: this.state.count + 3</span></span><br><span class="line"><span class="comment">      &#125;)</span></span><br><span class="line"><span class="comment">    &#125; */</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">	<span class="comment">// 初始化state</span></span><br><span class="line">  state = &#123; <span class="attr">count</span>: <span class="number">0</span> &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* </span></span><br><span class="line"><span class="comment">  问题: 类中定义的事件回调方法中this是undefined, 无法更新state</span></span><br><span class="line"><span class="comment">  原因: babel编译jsx. 采用的是严格模式, 事件监听函数中this就指向undefined</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  handle1 () &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>) <span class="comment">// this是undefined</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; <span class="comment">// 报错</span></span><br><span class="line">      <span class="attr">count</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span> + <span class="number">1</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handle2 () &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">count</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span> + <span class="number">2</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handle3 () &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">count</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span> + <span class="number">3</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* </span></span><br><span class="line"><span class="comment">  解决办法3 - 箭头函数</span></span><br><span class="line"><span class="comment">  原因: 改为箭头函数后, 变为了给组件对象添加属性, 且是在构造器中执行的, 用的就是构造函数中的this</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  handle4 = <span class="function">() =&gt;</span>  &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">count</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span> + <span class="number">3</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  render () &#123; <span class="comment">// render中的this是组件对象</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;render()&#x27;</span>, <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>当前count为: &#123;this.state.count&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handle1&#125;</span>&gt;</span>点击报错, 有this问题<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* </span></span><br><span class="line"><span class="language-xml">        解决办法1 - 包裹箭头函数</span></span><br><span class="line"><span class="language-xml">        原因: render中的this是组件对象, 处理函数是我们通过组件对象来调用的</span></span><br><span class="line"><span class="language-xml">        */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;this.handle2()&#125;&#125;&gt;解决办法1 - 包裹箭头函数<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handle3.bind(this)&#125;</span>&gt;</span>解决办法2 - bind绑定this <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handle4&#125;</span>&gt;</span>解决办法3 - 箭头函数<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>&#x3D;&#x3D;选择:&#x3D;&#x3D;</p>
<ol>
<li>一般用<code>箭头函数</code>方式,  编码简洁</li>
<li>如果要传递特定的数据, 一般选择用 <code>包裹箭头函数</code>方式</li>
</ol>
</blockquote>
<h3 id="参数传递"><a href="#参数传递" class="headerlink" title="参数传递"></a>参数传递</h3><p>情况一：获取event对象</p>
<ul>
<li>很多时候我们需要拿到event对象来做一些事情（比如阻止默认行为）</li>
<li>那么默认情况下，event对象有被直接传入，函数就可以获取到event对象；</li>
</ul>
<p>情况二：获取更多参数</p>
<p>有更多参数时，我们最好的方式就是<font color="red">传入一个箭头函数，主动执行的事件函数，并且传入相关的其他参数</font></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;text/babel&quot;</span>&gt;</span><br><span class="line">  <span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#root&#x27;</span>))</span><br><span class="line"></span><br><span class="line">  <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">super</span>()</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">        <span class="attr">message</span>: <span class="string">&#x27;hello world&#x27;</span>,</span><br><span class="line">        <span class="attr">count</span>: <span class="number">100</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 组件方法(实例方法)</span></span><br><span class="line">    <span class="title function_">increment</span>(<span class="params">e, name, age</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(name, <span class="string">&#x27;name&#x27;</span>);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(age, <span class="string">&#x27;age&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> &#123; message, count &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;message&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">h3</span>&gt;</span>当前计数为：&#123;count&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;/*  event传参 */&#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.increment.bind(this)&#125;</span>&gt;</span>按钮1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;(event)</span> =&gt;</span> this.increment(event)&#125;&gt;按钮2<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">          &#123;/*  额外参数的传参 */&#125;</span></span><br><span class="line"><span class="language-xml">          &#123;/*  参数 name age 会被覆盖，因为事件对象 会出现错位，不推荐使用 */&#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.increment.bind(this,</span> &#x27;<span class="attr">kobe</span>&#x27;, &#x27;<span class="attr">20</span>&#x27;)&#125;&gt;</span>按钮3<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;(event)</span> =&gt;</span> this.increment(event, &#x27;kobe&#x27;, 40)&#125;&gt;按钮4<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="render函数渲染时机"><a href="#render函数渲染时机" class="headerlink" title="render函数渲染时机"></a>render函数渲染时机</h3><blockquote>
<p>This.props和this.state改变时</p>
</blockquote>
<p>返回值：</p>
<p>React 元素：通常通过 JSX 创建。例如，<div> 会被 React 渲染为 DOM 节点，&lt;MyComponent &#x2F;&gt; 会被 React 渲染为自定义组件；无论是 <div> 还是 &lt;MyComponent &#x2F;&gt; 均为 React 元素。</div></div></p>
<p>数组或 fragments：使得 render 方法可以返回多个元素。</p>
<p>Portals：可以渲染子节点到不同的 DOM 子树中。字符串或数值类型：它们在 DOM 中会被渲染为文本节点布尔类型或 null：什么都不渲染。</p>
<h2 id="组件的props"><a href="#组件的props" class="headerlink" title="组件的props"></a>组件的props</h2><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>组件是封闭的，要接收外部数据应该通过 props 来实现</p>
<p>props的作用：父组件向子组件传递数据</p>
<p>父向子传入数据：给组件标签添加属性</p>
<p>子读取父传入的数据：函数组件通过参数props接收数据，类组件通过 this.props 接收数据</p>
<p><strong>props的特点</strong></p>
<ol>
<li>可以给组件传递任意类型的数据</li>
<li>props 是只读的对象，只能读取属性的值，不要修改props</li>
<li>可以通过…运算符来将对象的多个属性分别传入子组件</li>
<li>如果父组件传入的是动态的state数据, 那一旦父组件更新state数据, 子组件也会更新</li>
</ol>
<ul>
<li><p>子组件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 函数组件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">FunProps</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>FunProps-个人信息: 姓名: &#123;props.name&#125;, 年龄: &#123;props.age&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 类组件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">ClassProps</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; myName, age&#125; = <span class="variable language_">this</span>.<span class="property">props</span></span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>ClassProps-个人信息: 姓名: &#123;myName&#125;, 年龄: &#123;age&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>父组件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">person</span>: &#123;</span><br><span class="line">      <span class="attr">myName</span>: <span class="string">&#x27;tom&#x27;</span>,</span><br><span class="line">      <span class="attr">age</span>: <span class="number">12</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;myName, age&#125; = <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">person</span></span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>人员信息: &#123;myName + &#x27; : &#x27; +age&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          this.setState(&#123;</span></span><br><span class="line"><span class="language-xml">            person: &#123; myName: myName+&#x27;--&#x27;, age: age+1&#125;</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;更新人员信息<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">FunProps</span> <span class="attr">name</span>=<span class="string">&#123;myName&#125;</span> <span class="attr">age</span>=<span class="string">&#123;age&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">hr</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* <span class="tag">&lt;<span class="name">ClassProps</span> <span class="attr">myName</span>=<span class="string">&#123;myName&#125;</span> <span class="attr">age</span>=<span class="string">&#123;age&#125;/</span>&gt;</span> */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ClassProps</span> &#123;<span class="attr">...this.state.person</span>&#125;/&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="props校验与默认值"><a href="#props校验与默认值" class="headerlink" title="props校验与默认值"></a>props校验与默认值</h3><ul>
<li>props检验<ul>
<li>对于组件来说，props 是外来的，无法保证组件使用者传入什么格式的数据</li>
<li>如果传入的数据格式不对，可能会导致组件内部报错</li>
<li>关键问题：组件的使用者不知道明确的错误原因</li>
<li>允许在创建组件的时候，就指定 props 的类型、格式等</li>
<li>作用：捕获使用组件时因为props导致的错误，给出明确的错误提示，增加组件的健壮性</li>
</ul>
</li>
<li>props默认值<ul>
<li>给 props 设置默认值，在未传入 props 时生效</li>
</ul>
</li>
</ul>
<blockquote>
<p>props校验: 检查接收的prop的类型和必要性<br>props默认值: 如果prop没有传入, 指定默认值是多少</p>
</blockquote>
<blockquote>
<p>需求:</p>
<p>​		name&#x2F;myName属性: 字符串类型, 必须的<br>​		age属性: 数值类型, 不是必须的, 默认值为0</p>
</blockquote>
<p><strong>实现方式:</strong></p>
<ol>
<li>导入 prop-types 包</li>
<li>使用propTypes来给组件的props添加校验规则</li>
</ol>
<p>组件属性传递参数，传递的都是字符串！如果想传数字用{} 包裹</p>
<p>静态成员&#x3D;&#x3D;只能通过类来调用，不能在类的实例上调用；&#x3D;&#x3D;</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">PropTypes</span> <span class="keyword">from</span> <span class="string">&#x27;prop-types&#x27;</span> <span class="comment">// 引入属性检查的包</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 函数组件函数体外 */</span></span><br><span class="line"><span class="comment">// 指定prop的类型和必要性</span></span><br><span class="line"><span class="title class_">FunPropsCheck</span>.<span class="property">propTypes</span> = &#123;</span><br><span class="line">  <span class="attr">myName</span>: <span class="title class_">PropTypes</span>.<span class="property">string</span>.<span class="property">isRequired</span>, </span><br><span class="line">  <span class="attr">age</span>: <span class="title class_">PropTypes</span>.<span class="property">number</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 指定prop的默认值</span></span><br><span class="line"><span class="title class_">FunPropsCheck</span>.<span class="property">defaultProps</span> = &#123;</span><br><span class="line">  <span class="attr">age</span>: <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 类组件的类体中 */</span></span><br><span class="line"><span class="comment">// 指定prop的类型和必要性</span></span><br><span class="line"><span class="keyword">static</span> propTypes = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="title class_">PropTypes</span>.<span class="property">string</span>.<span class="property">isRequired</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="title class_">PropTypes</span>.<span class="property">number</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 指定prop的默认值</span></span><br><span class="line"><span class="keyword">static</span> defaultProps = &#123;</span><br><span class="line">  <span class="attr">age</span>: <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>案例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &quot;react&quot;;</span><br><span class="line">import PropTypes from &quot;prop-types&quot;;</span><br><span class="line">import &quot;../../style/style.css&quot;;</span><br><span class="line"></span><br><span class="line">export class MainBannerList extends Component &#123;</span><br><span class="line">  // 如果没有自己维护的数据，可以不写constructor</span><br><span class="line">  // constructor(props) &#123;</span><br><span class="line">  //   super(props);</span><br><span class="line">  // &#125;</span><br><span class="line"></span><br><span class="line">  // es2022以后的写法</span><br><span class="line">  // static propTypes = &#123;</span><br><span class="line">  //   bannerList: PropTypes.array.isRequired,</span><br><span class="line">  //   title: PropTypes.string,</span><br><span class="line">  // &#125;;</span><br><span class="line">  // static defaultProps = &#123;</span><br><span class="line">  //   title: &quot;默认标题&quot;,</span><br><span class="line">  //   bannerList: [],</span><br><span class="line">  // &#125;;</span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; bannerList, title &#125; = this.props;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div className=&quot;banner&quot;&gt;</span><br><span class="line">        标题:&#123;title&#125;</span><br><span class="line">        &lt;ul&gt;</span><br><span class="line">          &#123;bannerList.map((item, index) =&gt; &#123;</span><br><span class="line">            return &lt;li key=&#123;index&#125;&gt;&#123;item.title&#125;&lt;/li&gt;;</span><br><span class="line">          &#125;)&#125;</span><br><span class="line">        &lt;/ul&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MainBannerList.propTypes = &#123;</span><br><span class="line">  bannerList: PropTypes.array.isRequired,</span><br><span class="line">  title: PropTypes.string,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">MainBannerList.defaultProps = &#123;</span><br><span class="line">  title: &quot;默认标题&quot;,</span><br><span class="line">  bannerList: [],</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">export default MainBannerList;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="插槽"><a href="#插槽" class="headerlink" title="插槽"></a>插槽</h2><h3 id="基本插槽"><a href="#基本插槽" class="headerlink" title="基本插槽"></a>基本插槽</h3><p>React对于这种需要插槽的情况非常灵活，有两种方案可以实现</p>
<ul>
<li>组件的children子元素<ul>
<li><font color="red">如果只传一个，则children接收的就是该元素，如果传递多个，则children接收的是一个数组</font></li>
</ul>
</li>
<li>props属性传递React元素</li>
</ul>
<p>方式一：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &quot;react&quot;;</span><br><span class="line">import NavBar from &quot;./NavBar&quot;;</span><br><span class="line"></span><br><span class="line">export class App extends Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;NavBar&gt;</span><br><span class="line">          &lt;button&gt;按钮&lt;/button&gt;</span><br><span class="line">          &lt;h2&gt;标题&lt;/h2&gt;</span><br><span class="line">          &lt;i&gt;斜体文字&lt;/i&gt;</span><br><span class="line">        &lt;/NavBar&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default App;</span><br><span class="line"></span><br><span class="line">// 子组件</span><br><span class="line">import React, &#123; Component &#125; from &quot;react&quot;;</span><br><span class="line">import &quot;./style.css&quot;;</span><br><span class="line"></span><br><span class="line">export class NavBar extends Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; children &#125; = this.props;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div className=&quot;nav-bar&quot;&gt;</span><br><span class="line">        &lt;div className=&quot;left&quot;&gt;&#123;children[0]&#125;&lt;/div&gt;</span><br><span class="line">        &lt;div className=&quot;center&quot;&gt;&#123;children[1]&#125;&lt;/div&gt;</span><br><span class="line">        &lt;div className=&quot;right&quot;&gt;&#123;children[2]&#125;&lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">NavBar.propTypes = &#123;</span><br><span class="line">  // children: PropTypes.array.isRequired,// 限制必须传多个</span><br><span class="line">  children: PropTypes.element, // 限制必须传一个</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">export default NavBar;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>方法二：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &quot;react&quot;;</span><br><span class="line">import NavBar2 from &quot;./NavBar2&quot;;</span><br><span class="line"></span><br><span class="line">export class App extends Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &#123;/* 使用props */&#125;</span><br><span class="line">        &lt;NavBar2</span><br><span class="line">          leftSlot=&#123;&lt;button&gt;按钮2&lt;/button&gt;&#125;</span><br><span class="line">          centerSlot=&#123;&lt;h2&gt;标题2&lt;/h2&gt;&#125;</span><br><span class="line">          rightSlot=&#123;&lt;i&gt;斜体文字2&lt;/i&gt;&#125;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default App;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import React, &#123; Component &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">export class NavBar2 extends Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; leftSlot, centerSlot, rightSlot &#125; = this.props;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div className=&quot;nav-bar&quot;&gt;</span><br><span class="line">        &lt;div className=&quot;left&quot;&gt;&#123;leftSlot&#125;&lt;/div&gt;</span><br><span class="line">        &lt;div className=&quot;center&quot;&gt;&#123;centerSlot&#125;&lt;/div&gt;</span><br><span class="line">        &lt;div className=&quot;right&quot;&gt;&#123;rightSlot&#125;&lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default NavBar2;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="作用域插槽"><a href="#作用域插槽" class="headerlink" title="作用域插槽"></a>作用域插槽</h3><p>定义：标签由父组件决定，数据有子组件渲染</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &quot;react&quot;;</span><br><span class="line">import TabControl from &quot;./TabControl&quot;;</span><br><span class="line"></span><br><span class="line">export class App extends Component &#123;</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super();</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      titles: [&quot;流行&quot;, &quot;新款&quot;, &quot;精选&quot;],</span><br><span class="line">      tabIndex: 0,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  tabClick(tabIndex) &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      tabIndex,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  getItemType(item) &#123;</span><br><span class="line">    if (item === &quot;流行&quot;) &#123;</span><br><span class="line">      return &lt;button&gt;&#123;item&#125;&lt;/button&gt;;</span><br><span class="line">    &#125; else if (item === &quot;新款&quot;) &#123;</span><br><span class="line">      return &lt;h2&gt;&#123;item&#125;&lt;/h2&gt;;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      return &lt;i&gt;&#123;item&#125;&lt;/i&gt;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; titles, tabIndex &#125; = this.state;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;TabControl</span><br><span class="line">          titles=&#123;titles&#125;</span><br><span class="line">          tabClick=&#123;(index) =&gt; &#123;</span><br><span class="line">            this.tabClick(index);</span><br><span class="line">          &#125;&#125;</span><br><span class="line">          tabType=&#123;(item) =&gt; this.getItemType(item)&#125;</span><br><span class="line">        /&gt;</span><br><span class="line">        &lt;h1&gt;&#123;titles[tabIndex]&#125;&lt;/h1&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default App;</span><br><span class="line"></span><br><span class="line">import React, &#123; Component &#125; from &quot;react&quot;;</span><br><span class="line">import &quot;./style.css&quot;;</span><br><span class="line"></span><br><span class="line">export class TabControl extends Component &#123;</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super();</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      currentIndex: 0,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  itemClick(index) &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      currentIndex: index,</span><br><span class="line">    &#125;);</span><br><span class="line">    this.props.tabClick(index);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; titles, tabType &#125; = this.props;</span><br><span class="line">    const &#123; currentIndex &#125; = this.state;</span><br><span class="line"></span><br><span class="line">    return (</span><br><span class="line">      &lt;div className=&quot;tab-control&quot;&gt;</span><br><span class="line">        &#123;titles.map((item, index) =&gt; &#123;</span><br><span class="line">          return (</span><br><span class="line">            &lt;div</span><br><span class="line">              key=&#123;index&#125;</span><br><span class="line">              className=&#123;`item $&#123;currentIndex === index ? &quot;active&quot; : &quot;&quot;&#125;`&#125;</span><br><span class="line">              onClick=&#123;() =&gt; &#123;</span><br><span class="line">                this.itemClick(index);</span><br><span class="line">              &#125;&#125;</span><br><span class="line">            &gt;</span><br><span class="line">              &#123;/* &lt;span className=&quot;text&quot;&gt;&#123;item&#125;&lt;/span&gt; */&#125;</span><br><span class="line">              &#123;tabType(item)&#125;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          );</span><br><span class="line">        &#125;)&#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default TabControl;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="类组件的ref"><a href="#类组件的ref" class="headerlink" title="类组件的ref"></a>类组件的ref</h2><h3 id="理解"><a href="#理解" class="headerlink" title="理解"></a>理解</h3><p>组件内的标签可以定义ref属性来标识自己；</p>
<p>注意：官方提示，&#x3D;&#x3D;请勿过度使用ref&#x3D;&#x3D; ，</p>
<ul>
<li>有时可以省略ref：发生事件的事件源，和你要操作的元素是同一个，就可以省略<ul>
<li>可以用<code>event.target</code>代替</li>
</ul>
</li>
</ul>
<h3 id="编码"><a href="#编码" class="headerlink" title="编码"></a>编码</h3><ul>
<li><p>字符串形式的ref (尽量不要使用，以后可能会被废弃)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input ref=&#x27;input1&#x27; type=&quot;text&quot; /&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>回调形式的ref  (推荐使用)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input ref=&#123;c =&gt; this.input2 = c&#125; type=&quot;text&quot; /&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>存在的问题：<ul>
<li>在调用时会调用两次，第一次是null，第二次才是真正的执行回调</li>
<li>但是官网都说了，这是无关紧要的；</li>
</ul>
</li>
</ul>
</li>
<li><p>createRef创建ref容器  (繁琐，不太推荐)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">myRef = React.createRef()</span><br><span class="line">&lt;input ref=&#123;this.myRef&#125; type=&quot;text&quot; /&gt;</span><br><span class="line">  </span><br><span class="line">constructor() &#123;</span><br><span class="line">  super();</span><br><span class="line">  this.h2Ref = createRef();</span><br><span class="line">&#125;</span><br><span class="line">// 获取</span><br><span class="line">this.h2Ref.current</span><br></pre></td></tr></table></figure></li>
</ul>
<p>案例</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span>, createRef, forwardRef &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数式组件</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Home</span> = <span class="title function_">forwardRef</span>(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span> <span class="attr">ref</span>=<span class="string">&#123;ref&#125;</span>&gt;</span>我是home组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HelloWorld</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">test</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;----------&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello world<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">h2Ref</span> = <span class="title function_">createRef</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">hwRef</span> = <span class="title function_">createRef</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">homeRef</span> = <span class="title function_">createRef</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">titleEl</span> = <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">getNativeDOM</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 使用 refs 获取元素（即将被废弃）</span></span><br><span class="line">    <span class="comment">// console.log(this.refs.h2Ref);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用 createRef 获取元素</span></span><br><span class="line">    <span class="comment">// console.log(this.h2Ref.current);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用回调函数获取元素</span></span><br><span class="line">    <span class="comment">// console.log(this.titleEl);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用 ref 获取组件</span></span><br><span class="line">    <span class="comment">// this.hwRef.current.test();</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取函数式组件中的某个DOM元素</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">homeRef</span>.<span class="property">current</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        App</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span> <span class="attr">ref</span>=<span class="string">&quot;h2Ref&quot;</span>&gt;</span>hello world<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span> <span class="attr">ref</span>=<span class="string">&#123;this.h2Ref&#125;</span>&gt;</span>你好，储锐<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span> <span class="attr">ref</span>=<span class="string">&#123;(e)</span> =&gt;</span> (this.titleEl = e)&#125;&gt;hello Mr.储<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 获取组件 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">HelloWorld</span> <span class="attr">ref</span>=<span class="string">&#123;this.hwRef&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Home</span> <span class="attr">ref</span>=<span class="string">&#123;this.homeRef&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">            this.getNativeDOM();</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        &gt;</span></span><br><span class="line"><span class="language-xml">          获取原生DOM</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：</p>
<p>函数式组件是没有实例的，所以无法通过ref获取他们的实例：</p>
<ul>
<li><p>但是某些时候，我们可能想要获取函数式组件中的某个DOM元素；</p>
</li>
<li><p>这个时候我们可以通过 <code>forwardRef</code> ，将函数组件身上的ref绑定到其组件内部的某个DOM元素上</p>
</li>
</ul>
</blockquote>
<h3 id="事件处理-1"><a href="#事件处理-1" class="headerlink" title="事件处理"></a>事件处理</h3><ul>
<li>通过<code>onXxx</code>属性指定事件处理函数(注意大小写)<ul>
<li>React使用的是自定义(合成)事件, 而不是使用的原生DOM事件 – 为了更好的兼容性</li>
<li>React中的事件是通过<strong>事件委托方式</strong>处理的(委托给组件最外层的元素) – 高效</li>
</ul>
</li>
<li>通过event.target得到发生事件的DOM元素对象 – 不要过度使用ref</li>
</ul>
<h2 id="类组件的生命周期"><a href="#类组件的生命周期" class="headerlink" title="类组件的生命周期"></a>类组件的生命周期</h2><ul>
<li>组件从创建到死亡它会经历一些特定的阶段</li>
<li>React组件中包含一系列勾子函数(生命周期回调函数), 会在特定的时刻调用</li>
<li>我们在定义组件时，会在特定的生命周期回调函数中，做特定的工作</li>
<li>组件的生命周期函数的调用和其书写的位置无关；</li>
</ul>
<p>生命周期图谱: <a target="_blank" rel="noopener" href="https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/">https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/</a></p>
<h3 id="生命周期三大阶段"><a href="#生命周期三大阶段" class="headerlink" title="生命周期三大阶段"></a>生命周期三大阶段</h3><h4 id="挂载阶段"><a href="#挂载阶段" class="headerlink" title="挂载阶段"></a>挂载阶段</h4><blockquote>
<p>流程: constructor  &#x3D;&#x3D;&gt; render &#x3D;&#x3D;&gt; componentDidMount</p>
<p>触发: ReactDOM.render(): 渲染组件元素</p>
</blockquote>
<h4 id="更新阶段"><a href="#更新阶段" class="headerlink" title="更新阶段"></a>更新阶段</h4><blockquote>
<p>流程: render  &#x3D;&#x3D;&gt;  componentDidUpdate</p>
<p>触发: setState() , forceUpdate(), 组件接收到新的props</p>
</blockquote>
<h4 id="卸载阶段"><a href="#卸载阶段" class="headerlink" title="卸载阶段"></a>卸载阶段</h4><blockquote>
<p>流程: componentWillUnmount</p>
<p>触发: 不再渲染组件</p>
</blockquote>
<h3 id="生命周期钩子"><a href="#生命周期钩子" class="headerlink" title="生命周期钩子"></a>生命周期钩子</h3><ul>
<li><p>constructor:</p>
<p>只执行一次: 创建组件对象挂载第一个调用</p>
<p>用于初始化state属性或其它的实例属性或方法(可以简写到类体中)</p>
</li>
<li><p>render:</p>
<p>执行多次: 挂载一次 + 每次state&#x2F;props更新都会调用</p>
<p>用于返回要初始显示或更新显示的虚拟DOM界面</p>
</li>
<li><p><code>componentDidMount</code>:</p>
<p>执行一次: 在第一次调用render且组件界面已显示之后调用</p>
<p>用于初始执行一个异步操作: 发ajax请求&#x2F;启动定时器等</p>
</li>
<li><p><code>componentDidUpdate</code>:</p>
<p>执行多次: 组件界面更新(真实DOM更新)之后调用</p>
<p>用于数据变化后, 就会要自动做一些相关的工作(比如: 存储数据&#x2F;发请求)</p>
<p>执行render方法 &#x3D;&gt; 然后执行该生命周期</p>
</li>
<li><p><code>componentWillUnmount</code>:</p>
<p>执行一次: 在组件卸载前调用</p>
<p>用于做一些收尾工作, 如: 清除定时器</p>
</li>
</ul>
<h3 id="不常用生命周期钩子"><a href="#不常用生命周期钩子" class="headerlink" title="不常用生命周期钩子"></a>不常用生命周期钩子</h3><ul>
<li><p><code>shouldComponentUpdate</code>：</p>
<p>决定数据更新之后，是否执行render函数，返回false则不执行render函数</p>
<p>用于性能优化</p>
</li>
<li><p><code>getSnapshotBeforeUpdate</code>:</p>
<p>在React更新DOM之前回调的一个函数，可以获取DOM更新前的一些信息（比如说滚动位置）</p>
</li>
</ul>
<h3 id="旧版react生命周期-纯了解"><a href="#旧版react生命周期-纯了解" class="headerlink" title="旧版react生命周期(纯了解)"></a>旧版react生命周期(纯了解)</h3><blockquote>
<p>componentWillMount</p>
<p>componentWillUpdate,</p>
<p>componentWillReceiveProps</p>
<p>以上生命周期钩子函数在React v16.3后废弃</p>
</blockquote>
<h2 id="高阶组件"><a href="#高阶组件" class="headerlink" title="高阶组件"></a>高阶组件</h2><p>定义：高阶组件并不是React API的一部分，它是基于React的组合特性而形成的设计模式</p>
<p>接收一个组件作为参数，并且返回一个新的组件的<font color="red">函数</font></p>
<h3 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h3><p><strong>props增强</strong></p>
<p>案例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">enhancedUserInfo</span>(<span class="params">OriginComponent</span>) &#123;</span><br><span class="line">  <span class="keyword">class</span> <span class="title class_">NewComponent</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">super</span>();</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">        <span class="attr">userInfo</span>: &#123;</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&quot;coderwhy&quot;</span>,</span><br><span class="line">          <span class="attr">level</span>: <span class="number">99</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">OriginComponent</span> &#123;<span class="attr">...this.props</span>&#125; &#123;<span class="attr">...this.state.userInfo</span>&#125; /&gt;</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">NewComponent</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> enhancedUserInfo;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; PureComponent &#125; from &quot;react&quot;;</span><br><span class="line">import enhancedUserInfo from &quot;./hoc/enhanced_props&quot;;</span><br><span class="line"></span><br><span class="line">const Home = enhancedUserInfo(function (props) &#123;</span><br><span class="line">  return &lt;h1&gt;Home &#123;props.name&#125; &lt;/h1&gt;;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const Profile = enhancedUserInfo(function (props) &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h1&gt;Profile&lt;/h1&gt;</span><br><span class="line">      &lt;ul&gt;</span><br><span class="line">        &#123;props.banners.map((item, index) =&gt; &#123;</span><br><span class="line">          return &lt;li key=&#123;index&#125;&gt;&#123;item.title&#125;&lt;/li&gt;;</span><br><span class="line">        &#125;)&#125;</span><br><span class="line">      &lt;/ul&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export default class App extends PureComponent &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;Home /&gt;</span><br><span class="line">        &lt;Profile banners=&#123;[&#123; title: &quot;首页&quot; &#125;, &#123; title: &quot;个人中心&quot; &#125;]&#125; /&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Hooks"><a href="#Hooks" class="headerlink" title="Hooks"></a>Hooks</h2><blockquote>
<p>问题:<br>相对于类组件, 函数组件的编码更简单, 效率也更高, 但函数组件不能有state (旧版)</p>
<p>解决:<br>React 16.8版本设计了一套新的语法来让函数组件也可以有state</p>
</blockquote>
<ul>
<li><em>Hook</em> 是 React 16.8 的新增特性。它可以让你在不编写 class 的情况下使用 state 以及其他的 React 特性</li>
<li>Hook也叫钩子，<strong>本质就是函数</strong>，能让你使用 React 组件的状态和生命周期函数…</li>
<li>Hook 语法 基本已经代替了类组件的语法</li>
<li>后面的 React 项目就完全是用Hook语法了</li>
</ul>
<h3 id="useState"><a href="#useState" class="headerlink" title="useState()"></a>useState()</h3><blockquote>
<p>用来定义状态数据</p>
<p>可以多次调用, 产生多个状态数据</p>
<p><code>useState</code>(初始值): 返回包含内部管理的state数据和更新数据的函数的&#x3D;&#x3D;数组&#x3D;&#x3D;</p>
<ul>
<li><p>我们可以用解构的写法取出state数据和更新数据的函数</p>
<ul>
<li>   <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>参数1：相当于state中的数据</p>
</li>
<li><p>参数2：用来改变第一个元素的状态值，是一个函数，函数里的参数，就是要修改的状态值</p>
</li>
<li><p>第一次的useState的参数：count的初始值</p>
</li>
</ul>
</li>
<li><p><code>setCount</code> 里的参数就是修改的状态值，可以传入一个函数,&#x3D;&#x3D;注意这是一个异步的函数&#x3D;&#x3D;，修改后不会被立即改变</p>
</li>
<li>   <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 异步过程中，有可能取不到最新的值,通过传递一个回调函数进行获取</span></span><br><span class="line"><span class="keyword">let</span> [msg,setMsg] = <span class="title function_">useState</span>(<span class="string">&#x27;atguigu&#x27;</span>);</span><br><span class="line"><span class="title function_">setMsg</span>(msg+<span class="string">&#x27;_&#x27;</span>);<span class="comment">//正常设置</span></span><br><span class="line"><span class="title function_">setMsg</span>(<span class="function"><span class="params">msg</span>=&gt;</span>msg + <span class="string">&#x27;_&#x27;</span>);<span class="comment">//异步设置,此处的msg是最新的msg</span></span><br></pre></td></tr></table></figure></li>
</ul>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">/* </span></span><br><span class="line"><span class="comment">  useState(初始值): 返回包含内部管理的state数据和更新数据的函数的数组</span></span><br><span class="line"><span class="comment">  我们可以用解构的写法取出state数据和更新数据的函数</span></span><br><span class="line"><span class="comment">  state数据变量根据数据意义取名: xxx  =&gt; 界面根据xxx来显示</span></span><br><span class="line"><span class="comment">  更新数据的函数一般取名: setXxx =&gt; 调用setXxx会重新执行组件函数 (也就是重新render组件)</span></span><br><span class="line"><span class="comment">  第一次调用useState</span></span><br><span class="line"><span class="comment">  重新redner调用useState</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>)</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>App组件<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>state.count: &#123;count&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setCount(count + 1)&#125;&gt;更新count<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br></pre></td></tr></table></figure>

<h3 id="useEffect"><a href="#useEffect" class="headerlink" title="useEffect()"></a>useEffect()</h3><blockquote>
<p>可以在一个组件中多次使用</p>
<p>相当于<code>componentDidMount，componentDidUpdate 和 componentWillUnmount</code>的组合</p>
</blockquote>
<h4 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h4><blockquote>
<p>引入useEffect</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1. didMount 第二个参数传一个空数组</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;,[]);</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2. didMount + didUpdate</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;,[state | props])</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 3. didMount + 监听所有的state和所有的props</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;);<span class="comment">// 不传第二个参数</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 4. willUnmount</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">()=&gt;</span>&#123;<span class="comment">//didMount</span></span><br><span class="line">    <span class="comment">// 应用 ：设置定时器</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="comment">//willUnmount</span></span><br><span class="line">        <span class="comment">// 清空定时器</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;,[]);</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useState, useEffect, <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> style = &#123;</span><br><span class="line">  <span class="attr">border</span>: <span class="string">&#x27;1px solid gray&#x27;</span>,</span><br><span class="line">  <span class="attr">padding</span>: <span class="number">10</span>,</span><br><span class="line">  <span class="attr">margin</span>: <span class="string">&#x27;10px 0&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">HookTest</span>(<span class="params">&#123;count&#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [msg, setMsg] = <span class="title function_">useState</span>(<span class="string">&#x27;abc&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 相当于 componentDidMount</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;effect回调...&#x27;</span>)</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">    第一次执行HookLifeTest() =&gt; msg=abc, setTimeout(() =&gt; &#123;msg&#125;, 5000)</span></span><br><span class="line"><span class="comment">    更新执行HookLifeTest =&gt; msg=abc+   effect回调不会再执行</span></span><br><span class="line"><span class="comment">    注意: effect的回调当前情况只执行一次</span></span><br><span class="line"><span class="comment">    在setInterval中看到的msg一直都是初始值</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">const</span> timeoutId = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// setMsg(msg + &#x27;+&#x27;)  // 在setInterval中看到的msg一直都是初始值 =&gt; 界面只会更新一次</span></span><br><span class="line">      <span class="title function_">setMsg</span>(<span class="function"><span class="params">msg</span> =&gt;</span> msg + <span class="string">&#x27;+&#x27;</span>) <span class="comment">// setMsg的回调中的msg是react从内部取出的最新值 =&gt; 界面会多次更新</span></span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// effect回调返回的函数 相当于 willUnmount</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 清除定时器</span></span><br><span class="line">      <span class="built_in">clearTimeout</span>(timeoutId)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, []) <span class="comment">// 注意这里要传入空数组 </span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// componentDidMount + componentDidUpdate (所有state或props变化)</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;effect回调2&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="comment">// 与上面的等价</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;effect回调3&#x27;</span>)</span><br><span class="line">  &#125;, [count, msg])</span><br><span class="line"></span><br><span class="line">  <span class="comment">// componentDidMount + componentDidUpdate (msg变化)</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;effect回调3&#x27;</span>)</span><br><span class="line">  &#125;, [msg])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;style&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>LifeTest<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>state.msg: &#123;msg&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>props.count: &#123;count&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setMsg(msg + &#x27;+&#x27;)&#125;&gt;更新msg<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="useRef"><a href="#useRef" class="headerlink" title="useRef"></a>useRef</h3><blockquote>
<ul>
<li><p>用于得到组件中的某个DOM元素</p>
</li>
<li><p><strong>初始化的时候可以传递任何数据；并且可以被修改</strong></p>
<ul>
<li>案例：<strong>模拟didUpdate</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">let</span> flag = <span class="title function_">useRef</span>(<span class="literal">true</span>)</span><br><span class="line"><span class="comment">// console.log(flag);   &#123;current:true&#125;</span></span><br><span class="line"><span class="comment">//hooks第一次调用时初始值，第二次调用时就是最新的值</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (flag.<span class="property">current</span>) &#123;</span><br><span class="line">    flag.<span class="property">current</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;我是更新的时候执行的吗？&#x27;</span>);</span><br><span class="line">&#125;, [count])</span><br></pre></td></tr></table></figure></li>
</ul>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useRef &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">useRef: 用于得到组件中的某个DOM元素</span></span><br><span class="line"><span class="comment">1. 使用useRef创建用于存储input元素的容器对象(内部使用current属性存储)</span></span><br><span class="line"><span class="comment">2. 将ref容器通过ref属性交给表单项标签 =&gt; 渲染时内部会将对应的input元素保存到ref容器的current属性上</span></span><br><span class="line"><span class="comment">3. 点击提交按钮时, 通过ref容器的current属性得到input DOM元素 =&gt; 就可以读取其value了</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">HookTest2</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 1. 使用useRef创建用于存储input元素的容器对象(内部使用current属性存储)</span></span><br><span class="line">  <span class="keyword">const</span> inputRef = <span class="title function_">useRef</span>()</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(inputRef) <span class="comment">// &#123;current: undefined&#125;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleClick</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 3. 点击提交按钮时, 通过ref容器的current属性得到input DOM元素 =&gt; 就可以读取其value了</span></span><br><span class="line">    <span class="keyword">const</span> input = inputRef.<span class="property">current</span></span><br><span class="line">    <span class="title function_">alert</span>(input.<span class="property">value</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &#123;/* 2. 将ref容器通过ref属性交给表单项标签 =&gt; 渲染时内部会将对应的input元素保存到ref容器的current属性上 */&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">ref</span>=<span class="string">&#123;inputRef&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleClick&#125;</span>&gt;</span>提示输入框的值<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">HookTest2</span></span><br></pre></td></tr></table></figure>

<h3 id="useContext"><a href="#useContext" class="headerlink" title="useContext"></a>useContext</h3><blockquote>
<p>在hook组件函数中读取context的Provide提供的数数据</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Child</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> data = <span class="title function_">useContext</span>(context)</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;data&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Hook规则"><a href="#Hook规则" class="headerlink" title="Hook规则:"></a>Hook规则:</h3><ol>
<li>react hook 只能在<strong>函数组件</strong>或其他 hook(别人写的 hook 和<strong>自定义的 hook</strong>)</li>
<li><strong>在使用 hook 时,使用 hook 的代码,应该处于函数组件或自定义 hook 的顶级作用域</strong></li>
<li>(Hook调用的次数要固定, 所以不要在循环或条件判断中调用)</li>
</ol>
<h3 id="官方-Hooks"><a href="#官方-Hooks" class="headerlink" title="官方 Hooks"></a>官方 Hooks</h3><ul>
<li><a target="_blank" rel="noopener" href="https://react.docschina.org/docs/hooks-reference.html#basic-hooks">基础 Hook</a><ul>
<li><a target="_blank" rel="noopener" href="https://react.docschina.org/docs/hooks-reference.html#usestate"><code>useState</code></a></li>
<li><a target="_blank" rel="noopener" href="https://react.docschina.org/docs/hooks-reference.html#useeffect"><code>useEffect</code></a></li>
<li><a target="_blank" rel="noopener" href="https://react.docschina.org/docs/hooks-reference.html#usecontext"><code>useContext</code></a></li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://react.docschina.org/docs/hooks-reference.html#additional-hooks">额外的 Hook</a><ul>
<li><a target="_blank" rel="noopener" href="https://react.docschina.org/docs/hooks-reference.html#usereducer"><code>useReducer</code></a></li>
<li><a target="_blank" rel="noopener" href="https://react.docschina.org/docs/hooks-reference.html#usecallback"><code>useCallback</code></a></li>
<li><a target="_blank" rel="noopener" href="https://react.docschina.org/docs/hooks-reference.html#usememo"><code>useMemo</code></a></li>
<li><a target="_blank" rel="noopener" href="https://react.docschina.org/docs/hooks-reference.html#useref"><code>useRef</code></a></li>
<li><a target="_blank" rel="noopener" href="https://react.docschina.org/docs/hooks-reference.html#useimperativehandle"><code>useImperativeHandle</code></a></li>
<li><a target="_blank" rel="noopener" href="https://react.docschina.org/docs/hooks-reference.html#uselayouteffect"><code>useLayoutEffect</code></a></li>
<li><a target="_blank" rel="noopener" href="https://react.docschina.org/docs/hooks-reference.html#usedebugvalue"><code>useDebugValue</code></a></li>
</ul>
</li>
</ul>
<h2 id="收集表单数据"><a href="#收集表单数据" class="headerlink" title="收集表单数据"></a>收集表单数据</h2><h3 id="非受控组件"><a href="#非受控组件" class="headerlink" title="非受控组件"></a>非受控组件</h3><p>表单项不与state数据相向关联, 需要手动读取表单元素的值</p>
<p>借助于 useRef，使用原生 DOM 方式来获取表单元素值</p>
<p>useRef 的作用：用于获取 DOM元素</p>
<blockquote>
<p>&#x3D;&#x3D;注意：在form表单中的按钮，默认是提交到action中的地址&#x3D;&#x3D;</p>
<p><code>e.preventDefault()</code> 阻止默认跳转行为</p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;form&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>登陆页面<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line">  用户名: <span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>/&gt;</span></span> <span class="language-xml"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line">  密  码: <span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span>/&gt;</span></span> <span class="language-xml"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;登 陆&quot;</span>/&gt;</span></span></span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useRef &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">非受控组件:</span></span><br><span class="line"><span class="comment">  包含表单组件</span></span><br><span class="line"><span class="comment">  在输入过程中, 不将输入数据收集到state数据中, 只是提交的回调中手动读取input中的输入值</span></span><br><span class="line"><span class="comment">  表单项输入数据不与state数据相关联</span></span><br><span class="line"><span class="comment">编码过程</span></span><br><span class="line"><span class="comment">  1. 使用useRef创建用于存储input元素的容器对象(内部使用current属性存储)</span></span><br><span class="line"><span class="comment">  2. 将ref容器通过ref属性交给表单项标签 =&gt; 渲染时内部会将对应的input元素保存到ref容器的current属性上</span></span><br><span class="line"><span class="comment">  3. 点击提交按钮时, 通过ref容器的current属性得到input DOM元素 =&gt; 就可以读取其value了</span></span><br><span class="line"><span class="comment">不足:</span></span><br><span class="line"><span class="comment">  不够自动 / 不方便进行实时的数据检验</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">FormTest</span> () &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> nameRef = <span class="title function_">useRef</span>()</span><br><span class="line">  <span class="keyword">const</span> pwdRef = <span class="title function_">useRef</span>()</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(nameRef) <span class="comment">// &#123;current: undefined&#125;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 点击登陆的回调</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">login</span> = (<span class="params">event</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(nameRef)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 阻止事件的默认行为 =&gt; 不提交表单</span></span><br><span class="line">    event.<span class="title function_">preventDefault</span>()</span><br><span class="line">    <span class="comment">// 得到输入框</span></span><br><span class="line">    <span class="keyword">const</span> nameInput = nameRef.<span class="property">current</span></span><br><span class="line">    <span class="keyword">const</span> pwdInput = pwdRef.<span class="property">current</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 得到输入框的值</span></span><br><span class="line">    <span class="keyword">const</span> name = nameInput.<span class="property">value</span></span><br><span class="line">    <span class="keyword">const</span> pwd = pwdInput.<span class="property">value</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 发送登陆的请求</span></span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">`发送登陆的请求 name=<span class="subst">$&#123;name&#125;</span>, pwd=<span class="subst">$&#123;pwd&#125;</span>`</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>登陆页面(非受控组件)<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      用户名: <span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;nameRef&#125;</span>  <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>/&gt;</span> <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">      密  码: <span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;pwdRef&#125;</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span>/&gt;</span> <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;登 陆&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;login&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="受控组件"><a href="#受控组件" class="headerlink" title="受控组件"></a>受控组件</h3><p>组件中的表单项根据状态数据动态初始显示和更新显示, 当用户输入时实时同步到状态数据中</p>
<p>也就是实现了页面表单项与state数据的双向绑定</p>
<p>人话：表单中的value(checked)绑定了state中的数据</p>
<p><strong>实现方式</strong></p>
<ol>
<li>在 state 中添加一个状态，作为表单元素的value值（控制表单元素值的来源）</li>
<li>给表单元素绑定 change 事件，将 表单元素的值 设置为 state 的值（控制表单元素值的变化）</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">受控组件</span></span><br><span class="line"><span class="comment">  在输入过程, 实时收集到state数据中 / 界面也可以根据state数据进行显示</span></span><br><span class="line"><span class="comment">  表单项与state数据进行 双向同步 =&gt; 数据双向绑定  state &lt;===&gt; 页面的input</span></span><br><span class="line"><span class="comment">编码过程</span></span><br><span class="line"><span class="comment">  1. 使用useState定义一个state数据，作为表单元素的value值（界面根据state动态显示） </span></span><br><span class="line"><span class="comment">  2. 给表单元素绑定 change 事件，将 表单元素的值 设置为 state 的值（界面输入变化时, 保存到state)</span></span><br><span class="line"><span class="comment">数据双向绑定</span></span><br><span class="line"><span class="comment">  state 到 页面 的绑定 =&gt; 将state数据指定为input的value</span></span><br><span class="line"><span class="comment">  页面 到 state 的绑定 =&gt; 给input绑定change事件, 在回调中将输入的最新值更新到state</span></span><br><span class="line"><span class="comment">好处:</span></span><br><span class="line"><span class="comment">  实时自动收集数据 =&gt; 需要数据时非常轻松</span></span><br><span class="line"><span class="comment">  方便进行实时的数据检验</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">FormTest2</span> () &#123;</span><br><span class="line">  <span class="comment">// 定义state</span></span><br><span class="line">  <span class="keyword">const</span> [name, setName] = <span class="title function_">useState</span>(<span class="string">&#x27;admin&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> [pwd, setPwd] = <span class="title function_">useState</span>(<span class="string">&#x27;123&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleSubmit</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 点击提交按钮的默认行为就是提交表单, 但不想自动提交表单 =&gt; 阻止一下事件的默认行为</span></span><br><span class="line">    e.<span class="title function_">preventDefault</span>()</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">`准备提交登陆的ajax请求 name=<span class="subst">$&#123;name&#125;</span>, pwd=<span class="subst">$&#123;pwd&#125;</span>`</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 当用户名输入发生改变的回调</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleNameChange</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将最新输入的值更新到name状态</span></span><br><span class="line">    <span class="keyword">const</span> name = e.<span class="property">target</span>.<span class="property">value</span></span><br><span class="line">    <span class="title function_">setName</span>(e.<span class="property">target</span>.<span class="property">value</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 对name进行实时检验: 不能超过6位</span></span><br><span class="line">    <span class="keyword">if</span> (name.<span class="property">length</span>&gt;<span class="number">6</span>) &#123;</span><br><span class="line">      <span class="title function_">alert</span>(<span class="string">&#x27;用户名不能超过6位&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 当密码输入发生改变的回调</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handlePwdChange</span> = (<span class="params">event</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 将最新输入的值更新到pwd状态</span></span><br><span class="line">    <span class="title function_">setPwd</span>(event.<span class="property">target</span>.<span class="property">value</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>登陆页面(受控组件)<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&#x27;/xxx&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 2. 给表单元素绑定 change 事件，将 表单元素的值 设置为 state 的值 */&#125;</span></span><br><span class="line"><span class="language-xml">        用户名: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&#123;name&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;handleNameChange&#125;/</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        密码: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&#123;pwd&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;handlePwdChange&#125;/</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&#x27;登陆&#x27;</span> <span class="attr">onClick</span>=<span class="string">&#123;handleSubmit&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123; // 更新state, 界面会自动更新</span></span><br><span class="line"><span class="language-xml">        setName(name + &#x27;--&#x27;)</span></span><br><span class="line"><span class="language-xml">        setPwd(pwd + &#x27;--&#x27;)</span></span><br><span class="line"><span class="language-xml">      &#125;&#125;&gt;更新状态数据<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>优化: 使用同一个事件函数处理*多个事件</strong></p>
<blockquote>
<p>方式一: 柯里化函数</p>
<p>方式二: 包裹箭头函数</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">优化: 将2个事件函数优化为1个</span></span><br><span class="line"><span class="comment">方式一: 柯里化函数</span></span><br><span class="line"><span class="comment">方式二: 包裹箭头函数</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">FormTest3</span> () &#123;</span><br><span class="line">  <span class="comment">// 定义state</span></span><br><span class="line">  <span class="keyword">const</span> [name, setName] = <span class="title function_">useState</span>(<span class="string">&#x27;admin&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> [pwd, setPwd] = <span class="title function_">useState</span>(<span class="string">&#x27;123&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleSubmit</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">    e.<span class="title function_">preventDefault</span>()</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">`准备提交登陆的ajax请求 name=<span class="subst">$&#123;name&#125;</span>, pwd=<span class="subst">$&#123;pwd&#125;</span>`</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* </span></span><br><span class="line"><span class="comment">  方式一: 使用柯里化函数(也是一个高阶函数)</span></span><br><span class="line"><span class="comment">  return 后面的函数才是change事件要调用的函数</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleChange</span> = (<span class="params">setFn</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setFn</span>(event.<span class="property">target</span>.<span class="property">value</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* </span></span><br><span class="line"><span class="comment">  方式二: 包裹箭头函数: 在外部包一个事件回调函数, 我们在其中调用传递特定参数</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleChange2</span> = (<span class="params">event, setFn</span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setFn</span>(event.<span class="property">target</span>.<span class="property">value</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>登陆页面(受控组件)<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&#x27;/xxx&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        用户名: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&#123;name&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;handleChange(setName)&#125;/</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        密码: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&#123;pwd&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;handleChange(setPwd)&#125;/</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&#x27;登陆&#x27;</span> <span class="attr">onClick</span>=<span class="string">&#123;handleSubmit&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&#x27;/xxx&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        用户名: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&#123;name&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;event</span> =&gt;</span> handleChange2(event, setName)&#125;/&gt;<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        密码: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&#123;pwd&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;event</span> =&gt;</span> handleChange2(event, setPwd)&#125;/&gt;<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&#x27;登陆&#x27;</span> <span class="attr">onClick</span>=<span class="string">&#123;handleSubmit&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123; // 更新state, 界面会自动更新</span></span><br><span class="line"><span class="language-xml">        setName(name + &#x27;--&#x27;)</span></span><br><span class="line"><span class="language-xml">        setPwd(pwd + &#x27;--&#x27;)</span></span><br><span class="line"><span class="language-xml">      &#125;&#125;&gt;更新状态数据<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>类组件的优化</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; PureComponent &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">export default class App extends PureComponent &#123;</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super();</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      userName: &quot;&quot;,</span><br><span class="line">      password: &quot;&quot;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handleChange(event) &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      [event.target.name]: event.target.value,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; userName, password &#125; = this.state;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &#123;/* 用户名 */&#125;</span><br><span class="line">        用户名：</span><br><span class="line">        &lt;input</span><br><span class="line">          type=&quot;text&quot;</span><br><span class="line">          name=&quot;userName&quot;</span><br><span class="line">          value=&#123;userName&#125;</span><br><span class="line">          onChange=&#123;(event) =&gt; &#123;</span><br><span class="line">            this.handleChange(event);</span><br><span class="line">          &#125;&#125;</span><br><span class="line">        /&gt;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line">        &#123;/* 密码 */&#125;</span><br><span class="line">        密&amp;nbsp; 码：&#123;&quot; &quot;&#125;</span><br><span class="line">        &lt;input</span><br><span class="line">          type=&quot;password&quot;</span><br><span class="line">          name=&quot;password&quot;</span><br><span class="line">          value=&#123;password&#125;</span><br><span class="line">          onChange=&#123;(event) =&gt; &#123;</span><br><span class="line">            this.handleChange(event);</span><br><span class="line">          &#125;&#125;</span><br><span class="line">        /&gt;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line">        &lt;button</span><br><span class="line">          onClick=&#123;() =&gt; &#123;</span><br><span class="line">            console.log(userName, password);</span><br><span class="line">          &#125;&#125;</span><br><span class="line">        &gt;</span><br><span class="line">          提交</span><br><span class="line">        &lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>类组件复选框多选</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; PureComponent &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">export default class App extends PureComponent &#123;</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super();</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      hobbies: [</span><br><span class="line">        &#123; value: &quot;sing&quot;, text: &quot;唱&quot;, checked: false &#125;,</span><br><span class="line">        &#123; value: &quot;dance&quot;, text: &quot;跳&quot;, checked: false &#125;,</span><br><span class="line">        &#123; value: &quot;rap&quot;, text: &quot;rap&quot;, checked: false &#125;,</span><br><span class="line">      ],</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handleHobby(e, index) &#123;</span><br><span class="line">    const hobbies = [...this.state.hobbies];</span><br><span class="line">    hobbies[index].checked = e.target.checked;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      hobbies,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  submit() &#123;</span><br><span class="line">    const hobbies = this.state.hobbies</span><br><span class="line">      .filter((item) =&gt; item.checked)</span><br><span class="line">      .map((i) =&gt; i.value);</span><br><span class="line">    console.log(hobbies);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; userName, password, isAgree, hobbies &#125; = this.state;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &#123;/* 多个多选框 */&#125;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          你的爱好</span><br><span class="line">          &#123;hobbies.map((item, index) =&gt; &#123;</span><br><span class="line">            return (</span><br><span class="line">              &lt;label htmlFor=&#123;item.value&#125; key=&#123;index&#125;&gt;</span><br><span class="line">                &lt;input</span><br><span class="line">                  type=&quot;checkbox&quot;</span><br><span class="line">                  id=&#123;item.value&#125;</span><br><span class="line">                  checked=&#123;item.checked&#125;</span><br><span class="line">                  onChange=&#123;(event) =&gt; &#123;</span><br><span class="line">                    this.handleHobby(event, index);</span><br><span class="line">                  &#125;&#125;</span><br><span class="line">                /&gt;</span><br><span class="line">                &#123;item.text&#125;</span><br><span class="line">              &lt;/label&gt;</span><br><span class="line">            );</span><br><span class="line">          &#125;)&#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          &lt;button</span><br><span class="line">            onClick=&#123;() =&gt; &#123;</span><br><span class="line">              this.submit();</span><br><span class="line">            &#125;&#125;</span><br><span class="line">          &gt;</span><br><span class="line">            提交</span><br><span class="line">          &lt;/button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="案例-TODO-List-案例"><a href="#案例-TODO-List-案例" class="headerlink" title="案例- TODO List 案例"></a>案例- TODO List 案例</h2><p>=&#x3D;注：public下引入样式，一定要用  <strong>‘&#x2F;‘</strong>  , 不能使用 ‘.&#x2F; ‘,不然打包到线上是会找不到路径&#x3D;&#x3D;</p>
<p>解释：打包到线上时，public都会放到dist目录</p>
<p>整理：</p>
<blockquote>
<ul>
<li>只有数据发生变化时，react才会重新渲染<ul>
<li>因为数组、对象等引用类型里面的某个属性发生改变时，其地址值并不会发生改变，所以不会重新渲染</li>
<li>想要重新渲染，可以复制一个新的数组，执行setxxx方法<ul>
<li>复制数组的方法：[…arr]</li>
<li>map 返回的是一个函数调用的返回值</li>
<li>filter 返回的是一个true或者等价于true的 元素</li>
</ul>
</li>
</ul>
</li>
</ul>
</blockquote>
<blockquote>
<p>功能描述</p>
<ol>
<li>动态显示初始列表</li>
<li>添加一个 todo</li>
<li>删除一个 todo</li>
<li>反选一个 todo</li>
<li>todo 的全部数量和完成数量</li>
<li>全选&#x2F;全不选 todo</li>
<li>删除完成的 todo</li>
</ol>
</blockquote>
<h2 id="ajax"><a href="#ajax" class="headerlink" title="ajax"></a>ajax</h2><ul>
<li><p>在 react 项目开发中，基本都是使用 axios 库来发送 ajax请求与后台通信</p>
</li>
<li><p>而发 ajax 请求的时机分下面三种情况</p>
<ul>
<li>初始化发一次请求： 在<code>componentDidMount</code>中发送</li>
</ul>
</li>
<li><p>在<code>事件回调</code>函中发送请求</p>
</li>
<li><p>在某个state或props数据发生改变后发送请求： 在 <code>componentDidUpdate</code> 中发送</p>
</li>
<li><p>接口1: <a target="_blank" rel="noopener" href="https://api.github.com/search/repositories?q=re&amp;sort=stars">https://api.github.com/search/repositories?q=re&amp;sort=stars</a></p>
</li>
<li><p>接口2: <a target="_blank" rel="noopener" href="http://localhost:4000/search/users?q=rc">http://localhost:4000/search/users?q=rc</a></p>
</li>
</ul>
<h3 id="搭建后台接口"><a href="#搭建后台接口" class="headerlink" title="搭建后台接口"></a>搭建后台接口</h3><ul>
<li>server.js</li>
<li>使用 node + express + axios</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">后台服务器应用模块: 使用express快速搭建后台路由</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">&#x27;axios&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 能解析urlencode格式的post请求体参数</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>())</span><br><span class="line"><span class="comment">// 能解析json格式的请求体参数</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根路径路由</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(&#123;<span class="attr">status</span>: <span class="number">1</span>, <span class="attr">data</span>: <span class="string">&#x27;我是测试数据&#x27;</span>&#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 搜索用户的路由</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/search/users&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 得到query中的q参数</span></span><br><span class="line">  <span class="keyword">const</span> q = req.<span class="property">query</span>.<span class="property">q</span></span><br><span class="line">  <span class="comment">// 使用axios请求git的接口</span></span><br><span class="line">  axios.<span class="title function_">get</span>(<span class="string">&#x27;https://api.github.com/search/users&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">params</span>: &#123;q&#125;</span><br><span class="line">  &#125;)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 得到成功的响应数据</span></span><br><span class="line">      <span class="keyword">const</span> result = response.<span class="property">data</span></span><br><span class="line">      <span class="comment">// 返回给浏览</span></span><br><span class="line">      res.<span class="title function_">send</span>(result)</span><br><span class="line">    &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(error.<span class="property">message</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动监听服务</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="string">&#x27;4000&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;server listen on http://localhost:4000&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="react脚手架配置代理"><a href="#react脚手架配置代理" class="headerlink" title="react脚手架配置代理"></a>react脚手架配置代理</h3><blockquote>
<p>在package.json中追加如下配置</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;proxy&quot;</span><span class="punctuation">:</span><span class="string">&quot;http://localhost:4000&quot;</span></span><br></pre></td></tr></table></figure>

<p>说明：</p>
<ol>
<li>优点：配置简单，前端请求资源时可以不加任何前缀。</li>
<li>缺点：不能配置多个代理。&#x3D;&gt;<code> 后面项目中我们会讲解配置多个代理的方式</code></li>
<li>工作方式：上述方式配置代理，当请求的资源不存在时，那么该请求会转发给4000 （优先匹配前端资源）</li>
</ol>
<h2 id="组件通讯"><a href="#组件通讯" class="headerlink" title="组件通讯"></a>组件通讯</h2><blockquote>
<p>react组件通讯有三种方式.分别是props, context, pubsub</p>
</blockquote>
<h3 id="props"><a href="#props" class="headerlink" title="props"></a>props</h3><blockquote>
<p>单向数据流: 非函数属性通过标签属性, 由外层组件逐级传递给内层组件</p>
<p>父子间通信<br>祖孙间通信<br>兄弟间通信</p>
</blockquote>
<h3 id="context-了解"><a href="#context-了解" class="headerlink" title="context  (了解)"></a>context  (了解)</h3><blockquote>
<p>与任意后代直接通信</p>
<p>一般应用中不使用, 但一些插件库内部会使用context封装, 如: react-redux</p>
</blockquote>
<ul>
<li><p>调用 React. createContext() 创建 context 对象</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> context = <span class="title class_">React</span>.<span class="title function_">createContext</span>() </span><br><span class="line"><span class="comment">// 把context对象封装成一个模块。导入进行使用</span></span><br><span class="line"><span class="comment">//新建src-conntext.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> context = <span class="title class_">React</span>.<span class="title function_">createContext</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> context</span><br></pre></td></tr></table></figure>
</li>
<li><p>在<code>外部组件</code>中使用 context 上的 Provider 组件作为父节点, 使用value属性定义要传递的值，传递多个数据时，需要用对象包裹</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 提供数据</span></span><br><span class="line">&lt;context.<span class="property">Provider</span> value=&#123;要传递的值&#125;&gt;  </span><br><span class="line"> <span class="comment">//value=&#123;&#123; name: &quot;why&quot;, age: 18 &#125;&#125;</span></span><br><span class="line">	<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Child1</span> /&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span> </span><br><span class="line">&lt;/context.<span class="property">Provider</span>&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在<code>任意后代组件</code>中, 通过 React 的<code>useContext</code>读取数据</p>
<ul>
<li>类组件使用<code>组件名.contextType = context对象</code></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Child</span> () &#123;</span><br><span class="line">  <span class="keyword">const</span> data = <span class="title function_">useContext</span>(context)</span><br><span class="line">  <span class="comment">//data中就是祖先组件传过来的数据</span></span><br><span class="line">  <span class="comment">//如果传输的是一个对象，直接解构赋值即可</span></span><br><span class="line"><span class="comment">//let &#123;xxx,yyy&#125; = useContext(context);</span></span><br><span class="line">	<span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;data&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 类组件</span></span><br><span class="line"><span class="keyword">import</span> homeContext <span class="keyword">from</span> <span class="string">&quot;./ctx/homeCtx&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">HomeItem</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>homeItem<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;this.context.name&#125; - &#123;this.context.age&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">HomeItem</span>.<span class="property">contextType</span> = homeContext;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="默认值的使用"><a href="#默认值的使用" class="headerlink" title="默认值的使用"></a>默认值的使用</h4><p>组件不是context的子组件，并且想要使用context的值，此时使用默认值</p>
<blockquote>
<p>应用: 利用 context 改造 todos 案例</p>
</blockquote>
<h3 id="pubsub"><a href="#pubsub" class="headerlink" title="pubsub"></a>pubsub</h3><blockquote>
<p>兄弟&#x2F;任意组件间直接通信</p>
<p>发布订阅机制: publish &#x2F; subscribe<br>pubsub-js是一个用JS编写的库。<br>利用订阅发布模式, 当一个组件的状态发生了变化，可以通知其他任意组件更新这些变化</p>
<p>&#x3D;&#x3D;谁接收消息，谁订阅&#x3D;&#x3D;</p>
</blockquote>
<p><strong>实现:</strong></p>
<ul>
<li><p>安装</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install pubsub-js / yarn add pubsub-js</span><br></pre></td></tr></table></figure>
</li>
<li><p>导入</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">PubSub</span> <span class="keyword">from</span> <span class="string">&quot;pubsub-js&quot;</span> <span class="comment">// 导入的PubSub是一个对象.提供了发布/订阅的功能</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>pubsub-js 提供的方法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 订阅消息</span></span><br><span class="line"><span class="comment">// 参数一: 消息名</span></span><br><span class="line"><span class="comment">// 参数二: 用于接收数据的函数</span></span><br><span class="line"><span class="comment">// token 订阅消息返回的令牌(用于取消订阅)</span></span><br><span class="line"><span class="keyword">const</span> token = <span class="title class_">PubSub</span>.<span class="title function_">subscribe</span>(<span class="string">&#x27;消息名&#x27;</span>, <span class="keyword">function</span> (<span class="params">msg, data</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>( msg, data );</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 发布消息</span></span><br><span class="line"><span class="comment">// 参数一: 消息名</span></span><br><span class="line"><span class="comment">// 参数二: 要传递的数据</span></span><br><span class="line"><span class="title class_">PubSub</span>.<span class="title function_">publish</span>(<span class="string">&#x27;消息名&#x27;</span>, <span class="string">&#x27;hello world!&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 取消指定的订阅</span></span><br><span class="line"><span class="title class_">PubSub</span>.<span class="title function_">unsubscribe</span>(token);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 取消某个话题的所有订阅</span></span><br><span class="line"><span class="title class_">PubSub</span>.<span class="title function_">unsubscribe</span>(消息名);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">div.addEventListener(&#x27;click&#x27;, (event) =&gt; &#123;&#125;)</span></span><br><span class="line"><span class="comment">我们点击div =&gt; 浏览器自动帮我分发事件: 事件名, 包含事件相关数据的事件对象</span></span><br><span class="line"><span class="comment">div.removeEventListener(&#x27;click&#x27;)</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="Portals"><a href="#Portals" class="headerlink" title="Portals"></a>Portals</h2><p>某些情况下，我们希望渲染的内容独立于父组件，甚至是独立于当前挂载到的DOM元素中（默认都是挂载到id为root的DOM 元素上的）。</p>
<p>Portal 提供了一种将子节点渲染到存在于父组件以外的 DOM 节点的优秀的方案：</p>
<ul>
<li>第一个参数（child）是任何可渲染的 React 子元素，例如一个元素，字符串或 fragment；</li>
<li>第二个参数（container）是一个 DOM 元素；</li>
</ul>
<p>案例</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// App</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Model</span> <span class="keyword">from</span> <span class="string">&quot;./pages/Model&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        App</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Model</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">h2</span>&gt;</span>我是标题<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">p</span>&gt;</span>我是内容<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Model</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Model</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; createPortal &#125; <span class="keyword">from</span> <span class="string">&quot;react-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">Model</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;createPortal(this.props.children, document.querySelector(&quot;#model&quot;))&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Model</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Fragment"><a href="#Fragment" class="headerlink" title="Fragment"></a>Fragment</h2><blockquote>
<p>doucmentFragment: 是原生DOM中, 内存中可以用来保存多个DOM节点对象的容器</p>
<p>如果将这个fragment添加到页面中, 它本身不会进入页面, 它的所有子节点会进行页面</p>
<p>react组件中只能有一个根组件.</p>
<p>之前使用div包裹的方式会给html结构增加很多无用的层级</p>
<p>为了解决这个问题,可以使用React.Fragment</p>
</blockquote>
<p>注意：如果涉及渲染需要使用key时，<strong>不可以使用简写</strong></p>
<h3 id="测试DocumentFragment"><a href="#测试DocumentFragment" class="headerlink" title="测试DocumentFragment"></a>测试DocumentFragment</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>测试DocumentFragment<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;test&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> testDiv = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;test&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> h1 = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;h1&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    h1.<span class="property">innerHTML</span> = <span class="string">&#x27;我是标题&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> p = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;p&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    p.<span class="property">innerHTML</span> = <span class="string">&#x27;我是内容&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> fragment = <span class="variable language_">document</span>.<span class="title function_">createDocumentFragment</span>()</span></span><br><span class="line"><span class="language-javascript">    fragment.<span class="title function_">appendChild</span>(h1)</span></span><br><span class="line"><span class="language-javascript">    fragment.<span class="title function_">appendChild</span>(p)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    testDiv.<span class="title function_">appendChild</span>(fragment)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="不使用React-Fragment"><a href="#不使用React-Fragment" class="headerlink" title="不使用React.Fragment"></a>不使用React.Fragment</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Hello</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="comment">// 渲染到页面之后,这个div就是一个多余的</span></span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>fragment<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>hello react<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    ) </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="使用React-Fragment"><a href="#使用React-Fragment" class="headerlink" title="使用React.Fragment"></a>使用React.Fragment</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Hello</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="comment">// 这样就只会渲染h1和p</span></span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">React.Fragment</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>fragment<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>hello react<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">React.Fragment</span>&gt;</span></span></span><br><span class="line">    ) </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="使用简写-无名标签-lt-gt"><a href="#使用简写-无名标签-lt-gt" class="headerlink" title="使用简写(无名标签 &lt;&gt;)"></a>使用简写(无名标签 &lt;&gt;)</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Hello</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="comment">// 这是React.Fragment的简写形式</span></span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>fragment<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>hello react<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    ) </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="DocumentFragment-了解"><a href="#DocumentFragment-了解" class="headerlink" title="DocumentFragment (了解)"></a>DocumentFragment (了解)</h3><blockquote>
<p>&lt;React.Fragment&gt; 内部就是使用 DocumentFragment 实现的</p>
<p>DocumentFragment 是也是一种 DOM 节点, 它有2个特点</p>
<pre><code>  1. 它只存在于内存中, 它本身是不会进入页面显示的
  2. 它专门用来存放任意多个节点
  3. 如果将它添加到页面标签中, 那进入页面的是它的所有子节点
</code></pre>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;test&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 得到页面的空div</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> testDiv = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;test&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 创建h1标签, 并指定内容</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> h1 = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;h1&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  h1.<span class="property">innerHTML</span> = <span class="string">&#x27;我是标题&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 创建p标签, 并指定内容</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> p = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;p&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  p.<span class="property">innerHTML</span> = <span class="string">&#x27;我是内容&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 创建fragment容器, 将h1和p添加为它的子节点</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> fragment = <span class="variable language_">document</span>.<span class="title function_">createDocumentFragment</span>()</span></span><br><span class="line"><span class="language-javascript">  fragment.<span class="title function_">appendChild</span>(h1)</span></span><br><span class="line"><span class="language-javascript">  fragment.<span class="title function_">appendChild</span>(p)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 将fragment添加为页面div的子节点 =&gt; 但fragment不会进入页面</span></span></span><br><span class="line"><span class="language-javascript">  testDiv.<span class="title function_">appendChild</span>(fragment)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="严格模式"><a href="#严格模式" class="headerlink" title="严格模式"></a>严格模式</h2><p>StrictMode 是一个用来突出显示应用程序中潜在问题的工具：</p>
<ul>
<li>与 Fragment 一样，StrictMode 不会渲染任何可见的 UI；&amp;#x20;</li>
<li>它为其后代元素触发额外的检查和警告；&amp;#x20;</li>
<li>严格模式检查仅在开发模式下运行；它们不会影响生产构建；</li>
</ul>
<p>使用方法：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span>, <span class="title class_">StrictMode</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&quot;./Home&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        App</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">StrictMode</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Home</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">StrictMode</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="严格模式检查的是什么？"><a href="#严格模式检查的是什么？" class="headerlink" title="严格模式检查的是什么？"></a>严格模式检查的是什么？</h3><ol>
<li><p>识别不安全的生命周期：&amp;#x20;</p>
</li>
<li><p>使用过时的ref API&amp;#x20;</p>
</li>
<li><p>检查意外的副作用&amp;#x20;</p>
<ul>
<li>这个组件的constructor会被调用两次；&amp;#x20;</li>
<li>这是严格模式下故意进行的操作，让你来查看在这里写的一些逻辑代码被调用多次时，是否会产生一些副作用；&amp;#x20;</li>
<li>在生产环境中，是不会被调用两次的；&amp;#x20;</li>
</ul>
</li>
<li><p>使用废弃的findDOMNode方法&amp;#x20;</p>
<ul>
<li>在之前的React API中，可以通过findDOMNode来获取DOM，不过已经不推荐使用了</li>
</ul>
</li>
<li><p>检测过时的context API&amp;#x20;</p>
<ul>
<li>早期的Context是通过static属性声明Context对象属性，通过getChildContext返回Context对象等方式来使用Context的；&amp;#x20;</li>
<li>目前这种方式已经不推荐使用，大家可以自行学习了解一下它的用法；</li>
</ul>
</li>
</ol>
<h2 id="vue和react的异同"><a href="#vue和react的异同" class="headerlink" title="vue和react的异同"></a>vue和react的异同</h2><p>相同点</p>
<ul>
<li>数据驱动视图</li>
</ul>
<p>不同点</p>
<ul>
<li>渲染逻辑不同<ul>
<li>vue：template -&gt; render函数 -&gt; h函数 -&gt; 渲染成真实dom</li>
<li>react：render函数 -&gt; React.createElement() -&gt; 渲染成真实dom</li>
</ul>
</li>
<li>是否更新dom<ul>
<li>vue：数据劫持，vue底层封装好了</li>
<li>react：shouldComponentUpdate自己决定是否执行render函数</li>
</ul>
</li>
</ul>
<h2 id="setState的更多用法"><a href="#setState的更多用法" class="headerlink" title="setState的更多用法"></a>setState的更多用法</h2><ol>
<li>常规使用</li>
<li>setState可以传入一个回调函数<ol>
<li>好处一：可以在回调函数中边写新的state的逻辑</li>
<li>好处二：当前的回调函数会将之前的state和props传递进来</li>
</ol>
</li>
<li>setState在React的事件处理中是一个异步调用，如果要获取最新的结果然后处理对应的逻辑，可以传入第二个参数(回调函数)</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">export class App extends Component &#123;</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super();</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      message: &quot;hello react&quot;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  changeMessage() &#123;</span><br><span class="line">    // 常规用法</span><br><span class="line">    // this.setState(&#123; message: &quot;你好，储锐&quot; &#125;);</span><br><span class="line"></span><br><span class="line">    // setState可以传入一个回调函数</span><br><span class="line">    // this.setState((state, props) =&gt; &#123;</span><br><span class="line">    //   console.log(&quot;state&quot;, state);</span><br><span class="line">    //   console.log(&quot;props&quot;, props);</span><br><span class="line">    //   return &#123; message: &quot;你好，储锐&quot; &#125;;</span><br><span class="line">    // &#125;);</span><br><span class="line"></span><br><span class="line">    // setState在react的事件处理中是异步的</span><br><span class="line">    this.setState(&#123; message: &quot;你好，储锐&quot; &#125;, () =&gt; &#123;</span><br><span class="line">      console.log(&quot;+++++&quot;, this.state.message);</span><br><span class="line">    &#125;);</span><br><span class="line">    console.log(&quot;-----&quot;, this.state.message);</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; message &#125; = this.state;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h2&gt;&#123;message&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;button</span><br><span class="line">          onClick=&#123;() =&gt; &#123;</span><br><span class="line">            this.changeMessage();</span><br><span class="line">          &#125;&#125;</span><br><span class="line">        &gt;</span><br><span class="line">          修改</span><br><span class="line">        &lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default App;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="为什么设计成异步"><a href="#为什么设计成异步" class="headerlink" title="为什么设计成异步"></a>为什么设计成异步</h3><ul>
<li>setState设计为异步，可以显著的提升性能；<ul>
<li>如果每次调用 setState都进行一次更新，那么意味着render函数会被频繁调用，界面重新渲染，这样效率是很低的；</li>
<li>最好的办法应该是<font color="red">获取到多个更新，之后进行批量更新</font>；</li>
</ul>
</li>
<li>如果同步更新了state，但是还没有执行render函数，那么state和props不能保持同步；<ul>
<li>state和props不能保持一致性，会在开发中产生很多的问题；</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &quot;react&quot;;</span><br><span class="line"></span><br><span class="line">export class App extends Component &#123;</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super();</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      count: 0,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  countChange() &#123;</span><br><span class="line">    // 调用三次，最终结果为1,说明会合并</span><br><span class="line">    // this.setState(&#123; count: this.state.count + 1 &#125;);</span><br><span class="line">    // this.setState(&#123; count: this.state.count + 1 &#125;);</span><br><span class="line">    // this.setState(&#123; count: this.state.count + 1 &#125;);</span><br><span class="line"></span><br><span class="line">    // 调用三次</span><br><span class="line">    this.setState((state) =&gt; &#123;</span><br><span class="line">      return &#123; count: state.count + 1 &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line">    this.setState((state) =&gt; &#123;</span><br><span class="line">      return &#123; count: state.count + 1 &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line">    this.setState((state) =&gt; &#123;</span><br><span class="line">      return &#123; count: state.count + 1 &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    console.log(&quot;render函数执行了&quot;);</span><br><span class="line">    const &#123; count &#125; = this.state;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h2&gt;&#123;count&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;button</span><br><span class="line">          onClick=&#123;() =&gt; &#123;</span><br><span class="line">            this.countChange();</span><br><span class="line">          &#125;&#125;</span><br><span class="line">        &gt;</span><br><span class="line">          修改</span><br><span class="line">        &lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default App;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="setState都是异步的吗"><a href="#setState都是异步的吗" class="headerlink" title="setState都是异步的吗"></a>setState都是异步的吗</h3><ul>
<li>react18之前：<ul>
<li>react的事件处理都是异步的</li>
<li>原生事件处理、Promise、setTimeout等中的事件处理是同步的</li>
</ul>
</li>
<li>react18之后都是异步的</li>
</ul>
<p><font color="red">如果希望代码可以同步拿到，则需要执行特殊的<code>flushSync</code>操作</font></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &quot;react&quot;;</span><br><span class="line">import &#123; flushSync &#125; from &quot;react-dom&quot;;</span><br><span class="line"></span><br><span class="line">export class App extends Component &#123;</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super();</span><br><span class="line">    this.state = &#123; count: 0 &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  countChange() &#123;</span><br><span class="line">    flushSync(() =&gt; &#123;</span><br><span class="line">      this.setState(&#123; count: this.state.count + 1 &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    console.log(this.state.count); // 1</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    console.log(&quot;render函数执行了&quot;);</span><br><span class="line">    const &#123; count &#125; = this.state;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h2&gt;&#123;count&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;button</span><br><span class="line">          onClick=&#123;() =&gt; &#123;</span><br><span class="line">            this.countChange();</span><br><span class="line">          &#125;&#125;</span><br><span class="line">        &gt;</span><br><span class="line">          修改</span><br><span class="line">        &lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default App;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="性能优化"><a href="#性能优化" class="headerlink" title="性能优化"></a>性能优化</h2><h3 id="SCU"><a href="#SCU" class="headerlink" title="SCU"></a>SCU</h3><p>React给我们提供了一个生命周期方法 <code>shouldComponentUpdate</code>（很多时候，我们简称为<font color="red">SCU</font>），这个方法接受参数，并且需要有 返回值：</p>
<ul>
<li>该方法有两个参数：<ul>
<li>参数一：nextProps 修改之后，最新的props属性</li>
<li>参数二：nextState 修改之后，最新的state属性</li>
</ul>
</li>
<li>该方法返回值是一个boolean类型：<ul>
<li>返回值为true，那么就需要调用render方法；</li>
<li>返回值为false，那么久不需要调用render方法；</li>
<li>默认返回的是true，也就是只要state发生改变，就会调用render方法</li>
</ul>
</li>
<li>比如我们在App中增加一个message属性：<ul>
<li>jsx中并没有依赖这个message，那么它的改变不应该引起重新渲染；</li>
<li>但是因为render监听到state的改变，就会重新render，所以最后render方法还是被重新调用了</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &quot;react&quot;;</span><br><span class="line">import Home from &quot;./Home&quot;;</span><br><span class="line">import About from &quot;./About&quot;;</span><br><span class="line"></span><br><span class="line">export class App extends Component &#123;</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super();</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      count: 0,</span><br><span class="line">      message: &quot;hello world&quot;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 组件是否更新</span><br><span class="line">  shouldComponentUpdate(nextProps, nextState) &#123;</span><br><span class="line">    if (</span><br><span class="line">      this.state.message !== nextState.message ||</span><br><span class="line">      this.state.count !== nextState.count</span><br><span class="line">    ) &#123;</span><br><span class="line">      return true;</span><br><span class="line">    &#125;</span><br><span class="line">    return false;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  textChange() &#123;</span><br><span class="line">    // this.setState(&#123; message: &quot;你好，储锐&quot; &#125;);</span><br><span class="line">    this.setState(&#123; message: &quot;hello world&quot; &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; count, message &#125; = this.state;</span><br><span class="line">    console.log(&quot;App render&quot;);</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        App - &#123;count&#125; - &#123;message&#125;</span><br><span class="line">        &lt;p&gt;</span><br><span class="line">          &lt;button</span><br><span class="line">            onClick=&#123;() =&gt; &#123;</span><br><span class="line">              this.textChange();</span><br><span class="line">            &#125;&#125;</span><br><span class="line">          &gt;</span><br><span class="line">            修改</span><br><span class="line">          &lt;/button&gt;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">        &lt;Home /&gt;</span><br><span class="line">        &lt;About /&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default App;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="PureComponent"><a href="#PureComponent" class="headerlink" title="PureComponent"></a>PureComponent</h3><p>如果所有的类，我们都需要手动来实现 shouldComponentUpdate，那么会给我们开发者增加非常多的工作量。</p>
<p>事实上React已经考虑到了这一点，所以React已经默认帮我们实现好了，如何实现呢？</p>
<ul>
<li>将class继承自<code>PureComponent</code></li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">About</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;About render&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>About - &#123;this.props.count&#125; <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">About</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="memo"><a href="#memo" class="headerlink" title="memo"></a>memo</h3><p>函数组件使用<code>memo</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; memo &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Home</span> = <span class="title function_">memo</span>(<span class="function">(<span class="params">props</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Home render&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Home - &#123;props.message&#125; <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Home</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="shallowEqual方法"><a href="#shallowEqual方法" class="headerlink" title="shallowEqual方法"></a>shallowEqual方法</h3><p>问题：为什么不能直接修改state种引用类型的数据</p>
<p>使用了PureComponent，react底层会调用<code>shallowEqual</code>方法判断是否要执行<code>shouldComponentUpdate</code>钩子。</p>
<p><code>shallowEqual</code>方法只比较state里的引用类型的地址是否相同，是浅层比较，如果直接修改state里的引用类型数据，react底层会认为原始数据没有被修改，从而不执行render方法</p>
<h2 id="动画"><a href="#动画" class="headerlink" title="动画"></a>动画</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install react-transition-group</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://reactcommunity.org/react-transition-group/transition">官网</a></p>
<p>react-transition-group主要包含四个组件：</p>
<ul>
<li>ransition<ul>
<li>该组件是一个和平台无关的组件（不一定要结合CSS）；</li>
<li>在前端开发中，我们一般是结合CSS来完成样式，所以比较常用的是CSSTransition；</li>
</ul>
</li>
<li>CSSTransition<ul>
<li>在前端开发中，通常使用CSSTransition来完成过渡动画效果</li>
</ul>
</li>
<li>witchTransition<ul>
<li>两个组件显示和隐藏切换时，使用该组件</li>
</ul>
</li>
<li>TransitionGroup<ul>
<li>将多个动画组件包裹在其中，一般用于列表中元素的动画；</li>
</ul>
</li>
</ul>
<h3 id="CSSTransition"><a href="#CSSTransition" class="headerlink" title="CSSTransition"></a>CSSTransition</h3><p>CSSTransition执行过程中，有三个状态：appear、enter、exit；</p>
<p>它们有三种状态，需要定义对应的CSS样式：</p>
<ul>
<li>第一类，开始状态：对于的类是-appear、-enter、exit；</li>
<li>第二类：执行动画：对应的类是-appear-active、-enter-active、-exit-active；</li>
<li>第三类：执行结束：对应的类是-appear-done、-enter-done、-exit-done；</li>
</ul>
<h4 id="常见属性"><a href="#常见属性" class="headerlink" title="常见属性"></a>常见属性</h4><p>in：触发进入或者退出状态</p>
<ul>
<li>如果添加了unmountOnExit&#x3D;{true}，那么该组件会在执行退出动画结束后被移除掉；</li>
<li>当in为true时，触发进入状态，会添加-enter、-enter-acitve的class开始执行动画，当动画执行结束后，会移除两个class，并且添加-enter-done的class；</li>
<li>当in为false时，触发退出状态，会添加-exit、-exit-active的class开始执行动画，当动画执行结束后，会移除两个class，并且添加-enter-done的class；</li>
</ul>
<p>lassNames：动画class的名称</p>
<ul>
<li>决定了在编写css时，对应的class名称：比如card-enter、card-enter-active、card-enter-done；</li>
</ul>
<p>timeout：</p>
<ul>
<li>过渡动画的时间</li>
</ul>
<p>ppear：</p>
<ul>
<li>是否在初次进入添加动画（需要和in同时为true）</li>
</ul>
<p>unmountOnExit：退出后卸载组件</p>
<p>CSSTransition对应的钩子函数：主要为了检测动画的执行过程，来完成一些JavaScript的操作</p>
<ul>
<li>onEnter：在进入动画之前被触发；</li>
<li>onEntering：在应用进入动画时被触发；</li>
<li>onEntered：在应用进入动画结束后被触发；</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">CSSTransition</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-transition-group&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;./style.css&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">isShow</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; isShow &#125; = <span class="variable language_">this</span>.<span class="property">state</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.setState(&#123; isShow: !isShow &#125;)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">          Toggle</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">CSSTransition</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">appear</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">in</span>=<span class="string">&#123;isShow&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">unmountOnExit</span>=<span class="string">&#123;true&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">timeout</span>=<span class="string">&#123;2000&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">classNames</span>=<span class="string">&quot;test&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onEnter</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">            console.log(&quot;开始进入动画&quot;);</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;</span></span><br><span class="line"><span class="language-xml">          onEntering=&#123;() =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            console.log(&quot;执行进入动画&quot;);</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;</span></span><br><span class="line"><span class="language-xml">          onEntered=&#123;() =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            console.log(&quot;进入结束&quot;);</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;</span></span><br><span class="line"><span class="language-xml">          onExit=&#123;() =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            console.log(&quot;开始退出动画&quot;);</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;</span></span><br><span class="line"><span class="language-xml">          onExiting=&#123;() =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            console.log(&quot;执行退出动画&quot;);</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;</span></span><br><span class="line"><span class="language-xml">          onExited=&#123;() =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            console.log(&quot;退出结束&quot;);</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        &gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">h1</span>&gt;</span>哈哈哈哈哈哈哈<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">CSSTransition</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// css</span></span><br><span class="line">.<span class="property">test</span>-appear &#123;</span><br><span class="line">  <span class="attr">transform</span>: <span class="title function_">translateX</span>(-200px);</span><br><span class="line">&#125;</span><br><span class="line">.<span class="property">test</span>-appear-active &#123;</span><br><span class="line">  <span class="attr">transform</span>: <span class="title function_">translateX</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="attr">transition</span>: transform 2s ease;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">.<span class="property">test</span>-enter &#123;</span><br><span class="line">  <span class="attr">opacity</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.<span class="property">test</span>-enter-active &#123;</span><br><span class="line">  <span class="attr">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attr">transition</span>: all 2s ease;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.<span class="property">test</span>-exit &#123;</span><br><span class="line">  <span class="attr">opacity</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.<span class="property">test</span>-exit-active &#123;</span><br><span class="line">  <span class="attr">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attr">transition</span>: all 2s ease;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="SwitchTransition"><a href="#SwitchTransition" class="headerlink" title="SwitchTransition"></a>SwitchTransition</h3><p>SwitchTransition可以完成两个组件之间切换的炫酷动画</p>
<p>SwitchTransition中主要有一个属性：mode，有两个值</p>
<ul>
<li>in-out：表示新组件先进入，旧组件再移除；</li>
<li>out-in：表示就组件先移除，新组建再进入</li>
</ul>
<p>使用：</p>
<ul>
<li>SwitchTransition组件里面要有CSSTransition或者Transition组件，不能直接包裹你想要切换的组件；</li>
<li>SwitchTransition里面的CSSTransition或Transition组件不再像以前那样接受in属性来判断元素是何种状态，取而代之的是<font color="red">key属性</font>；</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">CSSTransition</span>, <span class="title class_">SwitchTransition</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-transition-group&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./style.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line"> <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">   <span class="variable language_">super</span>();</span><br><span class="line">   <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">     <span class="attr">isShow</span>: <span class="literal">true</span>,</span><br><span class="line">   &#125;;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">   <span class="keyword">const</span> &#123; isShow &#125; = <span class="variable language_">this</span>.<span class="property">state</span>;</span><br><span class="line">   <span class="keyword">return</span> (</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">SwitchTransition</span> <span class="attr">mode</span>=<span class="string">&quot;out-in&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">CSSTransition</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">           <span class="attr">key</span>=<span class="string">&#123;isShow</span> ? &quot;<span class="attr">exit</span>&quot; <span class="attr">:</span> &quot;<span class="attr">login</span>&quot;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">           <span class="attr">classNames</span>=<span class="string">&quot;login&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">           <span class="attr">timeout</span>=<span class="string">&#123;1000&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">         &gt;</span></span></span><br><span class="line"><span class="language-xml">           <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.setState(&#123; isShow: !isShow &#125;)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">             &#123;isShow ? &quot;退出&quot; : &quot;登录&quot;&#125;</span></span><br><span class="line"><span class="language-xml">           <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;/<span class="name">CSSTransition</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;/<span class="name">SwitchTransition</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">   );</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// css</span></span><br><span class="line">.<span class="property">login</span>-enter &#123;</span><br><span class="line"> <span class="attr">transform</span>: <span class="title function_">translateX</span>(100px);</span><br><span class="line"> <span class="attr">opacity</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.<span class="property">login</span>-enter-active &#123;</span><br><span class="line"> <span class="attr">transform</span>: <span class="title function_">translateX</span>(<span class="number">0</span>);</span><br><span class="line"> <span class="attr">opacity</span>: <span class="number">1</span>;</span><br><span class="line"> <span class="attr">transition</span>: all 1s ease;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.<span class="property">login</span>-exit &#123;</span><br><span class="line"> <span class="attr">transform</span>: <span class="title function_">translateX</span>(<span class="number">0</span>);</span><br><span class="line"> <span class="attr">opacity</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.<span class="property">login</span>-exit-active &#123;</span><br><span class="line"> <span class="attr">transform</span>: <span class="title function_">translateX</span>(-100px);</span><br><span class="line"> <span class="attr">opacity</span>: <span class="number">0</span>;</span><br><span class="line"> <span class="attr">transition</span>: all 1s ease;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="TransitionGroup"><a href="#TransitionGroup" class="headerlink" title="TransitionGroup"></a>TransitionGroup</h3><p>当我们有一组动画时，需要将这些CSSTransition放入到一个TransitionGroup中来完成动画</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">TransitionGroup</span>, <span class="title class_">CSSTransition</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-transition-group&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;./style.css&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">books</span>: [</span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">111</span>, <span class="attr">name</span>: <span class="string">&quot;你不知道JS&quot;</span>, <span class="attr">price</span>: <span class="number">99</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">222</span>, <span class="attr">name</span>: <span class="string">&quot;JS高级程序设计&quot;</span>, <span class="attr">price</span>: <span class="number">88</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">333</span>, <span class="attr">name</span>: <span class="string">&quot;Vuejs高级设计&quot;</span>, <span class="attr">price</span>: <span class="number">77</span> &#125;,</span><br><span class="line">      ],</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">addNewBook</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> books = [...<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">books</span>];</span><br><span class="line">    books.<span class="title function_">push</span>(&#123;</span><br><span class="line">      <span class="attr">id</span>: <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>(),</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;React高级程序设计&quot;</span>,</span><br><span class="line">      <span class="attr">price</span>: <span class="number">99</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; books &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">removeBook</span>(<span class="params">index</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> books = [...<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">books</span>];</span><br><span class="line">    books.<span class="title function_">splice</span>(index, <span class="number">1</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; books &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; books &#125; = <span class="variable language_">this</span>.<span class="property">state</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>书籍列表:<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">TransitionGroup</span> <span class="attr">component</span>=<span class="string">&quot;ul&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;books.map((item, index) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            return (</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">CSSTransition</span> <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span> <span class="attr">classNames</span>=<span class="string">&quot;book&quot;</span> <span class="attr">timeout</span>=<span class="string">&#123;1000&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    &#123;item.name&#125;-&#123;item.price&#125;</span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;(e)</span> =&gt;</span> this.removeBook(index)&#125;&gt;删除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;/<span class="name">CSSTransition</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            );</span></span><br><span class="line"><span class="language-xml">          &#125;)&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">TransitionGroup</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;(e)</span> =&gt;</span> this.addNewBook()&#125;&gt;添加新书籍<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="React中的CSS"><a href="#React中的CSS" class="headerlink" title="React中的CSS"></a>React中的CSS</h2><h3 id="内联样式"><a href="#内联样式" class="headerlink" title="内联样式"></a>内联样式</h3><ul>
<li>使用小驼峰命名属性的JavaScript对象</li>
<li>可以使用state中的变量</li>
</ul>
<p><strong>优点</strong></p>
<ol>
<li>样式间不会有冲突</li>
<li>可以动态获取state中的样式</li>
</ol>
<p><strong>缺点</strong><br>混乱、要是用驼峰、没有提示、某些样式无法编写（伪类&#x2F;伪元素）</p>
<h3 id="普通的css"><a href="#普通的css" class="headerlink" title="普通的css"></a>普通的css</h3><p>通常是编写到单独的文件，然后引入</p>
<p>组件化开发，普通的css样式是全局样式，相互之间会有影响</p>
<h3 id="css-modules"><a href="#css-modules" class="headerlink" title="css modules"></a>css modules</h3><p>css modules并不是React特有的解决方案，而是所有使用了类似于<font color="red">webpack配置</font>的环境下都可以使用的。<br>如果在其他项目中使用它，那么我们需要自己来进行配置，比如配置<font color="red">webpack.config.js中的modules: true</font>等</p>
<p>React的脚手架已经内置了css modules的配置：</p>
<ul>
<li><font color="red">.css&#x2F;.less&#x2F;.scss 等样式文件</font>都需要修改成<font color="red">.module.css&#x2F;.module.less&#x2F;.module.scss</font> 等；</li>
<li>之后就可以引用并且进行使用了；</li>
</ul>
<p><strong>缺点</strong></p>
<ul>
<li>引用的类名，不能使用连接符(.home-title)，在JavaScript中是不识别的；</li>
<li><font color="red">所有的className都必须使用{style.className} 的形式</font>来编写；</li>
<li>不方便动态来修改某些样式，依然需要使用内联样式的方式；</li>
</ul>
<h3 id="css-in-js"><a href="#css-in-js" class="headerlink" title="css in js"></a>css in js</h3><p>目前比较流行的CSS-in-JS的库有哪些呢？</p>
<ul>
<li>styled-components</li>
<li>emotion</li>
<li>glamorous</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i styled-components</span><br></pre></td></tr></table></figure>

<h4 id="ES6标签模板字符串"><a href="#ES6标签模板字符串" class="headerlink" title="ES6标签模板字符串"></a>ES6标签模板字符串</h4><p>正常情况下，我们都是通过 函数名() 方式来进行调用的，其实函数还有另外一种调用方式：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(args);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">foo</span>(<span class="string">&quot;hello world&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> name = <span class="string">&quot;zhangsan&quot;</span>;</span><br><span class="line">foo<span class="string">`hello <span class="subst">$&#123;name&#125;</span>`</span>; <span class="comment">// [[&#x27;hello&#x27;,&quot;&quot;],&#x27;zhangsan&#x27;]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>如果我们在调用的时候插入其他的变量：</p>
<ul>
<li>模板字符串被拆分了；</li>
<li>第一个元素是数组，是被模块字符串拆分的字符串组合；</li>
<li>后面的元素是一个个模块字符串传入的内容；</li>
</ul>
<h4 id="styled的基本使用"><a href="#styled的基本使用" class="headerlink" title="styled的基本使用"></a>styled的基本使用</h4><p>VSCode中安装插件：<code>vscode-styled-components</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">HomeWrapper</span>, <span class="title class_">FooterWrapper</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./style&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">size</span>: <span class="number">20</span>,</span><br><span class="line">      <span class="attr">color</span>: <span class="string">&quot;orange&quot;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; size, color &#125; = <span class="variable language_">this</span>.<span class="property">state</span>;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">HomeWrapper</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">h2</span> <span class="attr">className</span>=<span class="string">&quot;title&quot;</span>&gt;</span>我是Home标题<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">li</span>&gt;</span>我是列表1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">li</span>&gt;</span>我是列表2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">li</span>&gt;</span>我是列表3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">FooterWrapper</span> <span class="attr">size</span>=<span class="string">&#123;size&#125;</span> <span class="attr">color</span>=<span class="string">&#123;color&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;footer&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">div</span>&gt;</span>版权声明<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">div</span>&gt;</span>关于我们<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.setState(&#123; color: &quot;skyblue&quot; &#125;)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">              修改颜色</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">FooterWrapper</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">HomeWrapper</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// css</span></span><br><span class="line"><span class="keyword">import</span> styled <span class="keyword">from</span> <span class="string">&quot;styled-components&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> varb <span class="keyword">from</span> <span class="string">&quot;./style/variables&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">HomeWrapper</span> = styled.<span class="property">div</span><span class="string">`</span></span><br><span class="line"><span class="string">  .title &#123;</span></span><br><span class="line"><span class="string">    color: red;</span></span><br><span class="line"><span class="string">    &amp;:hover &#123;</span></span><br><span class="line"><span class="string">      color: red;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子元素单独抽取到一个样式</span></span><br><span class="line"><span class="comment">// 可以接受外部传入的props</span></span><br><span class="line"><span class="comment">// 可以通过attrs给标签模板字符串中提供属性</span></span><br><span class="line"><span class="comment">// 从一个单独的文件中引入变量</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">FooterWrapper</span> = styled.<span class="property">div</span>.<span class="title function_">attrs</span>(<span class="function">(<span class="params">props</span>) =&gt;</span> (&#123;</span><br><span class="line">  <span class="attr">color</span>: props.<span class="property">color</span> || <span class="string">&quot;blue&quot;</span>,</span><br><span class="line">&#125;))<span class="string">`</span></span><br><span class="line"><span class="string">  .footer &#123;</span></span><br><span class="line"><span class="string">    color: <span class="subst">$&#123;varb.primaryColor&#125;</span>;</span></span><br><span class="line"><span class="string">    font-size: <span class="subst">$&#123;(props) =&gt; props.sizes&#125;</span>px;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &amp;:hover &#123;</span></span><br><span class="line"><span class="string">      color: <span class="subst">$&#123;(props) =&gt; props.color&#125;</span>;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//variables.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> primaryColor = <span class="string">&quot;#ff0033&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> secondaryColor = <span class="string">&quot;#00bcd4&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> smallSize = <span class="string">&quot;12px&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> middleSize = <span class="string">&quot;14px&quot;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="动态添加class"><a href="#动态添加class" class="headerlink" title="动态添加class"></a>动态添加class</h3><ol>
<li>使用三元运算符</li>
<li>使用数组</li>
<li>使用第三方库<code>classnames</code></li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> classNames <span class="keyword">from</span> <span class="string">&quot;classnames&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">isBbb</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">isCcc</span>: <span class="literal">false</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; isBbb, isCcc &#125; = <span class="variable language_">this</span>.<span class="property">state</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> classList = [<span class="string">&quot;aaa&quot;</span>];</span><br><span class="line">    <span class="keyword">if</span> (isBbb) classList.<span class="title function_">push</span>(<span class="string">&quot;bbb&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (isCcc) classList.<span class="title function_">push</span>(<span class="string">&quot;ccc&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span> <span class="attr">className</span>=<span class="string">&#123;</span>`<span class="attr">aaa</span> $&#123;<span class="attr">isBbb</span> ? &quot;<span class="attr">bbb</span>&quot; <span class="attr">:</span> &quot;&quot;&#125; $&#123;<span class="attr">isCcc</span> ? &quot;<span class="attr">ccc</span>&quot; <span class="attr">:</span> &quot;&quot;&#125;`&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          哈哈哈</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span> <span class="attr">className</span>=<span class="string">&#123;classList.join(</span>&quot; &quot;)&#125;&gt;</span>呵呵呵<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span> <span class="attr">className</span>=<span class="string">&#123;classNames(</span>&quot;<span class="attr">aaa</span>&quot;, &#123; <span class="attr">bbb:</span> <span class="attr">isBbb</span>, <span class="attr">ccc:</span> <span class="attr">isCcc</span> &#125;)&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          嘿嘿嘿</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Redux状态管理工具"><a href="#Redux状态管理工具" class="headerlink" title="Redux状态管理工具"></a>Redux状态管理工具</h2><p>Redux的使用过程</p>
<ol>
<li>创建一个对象，作为我们要保存的状态</li>
<li>创建Store来储存这个对象<ul>
<li>创建store时必须创建reducer</li>
<li>我们可以通过<code>store.getState</code>来获取当前的state</li>
</ul>
</li>
<li>通过action来修改state<ul>
<li>通过dispatch来派发action</li>
<li>通常action中都会有type属性，也可以携带其他的数据</li>
</ul>
</li>
<li>修改reducer中的处理代码<br>reducer是一个纯函数，不能直接修改state中的数据</li>
<li>可以在派发action之前，监听store的变化</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 监听store变化</span></span><br><span class="line">  <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    store.<span class="title function_">subscribe</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> counter = store.<span class="title function_">getState</span>().<span class="property">counter</span>;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">        counter,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line"><span class="comment">// 取消监听</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="在react中使用redux"><a href="#在react中使用redux" class="headerlink" title="在react中使用redux"></a>在react中使用redux</h3><p>安装：<code>npm i redux react-redux</code></p>
<p><strong>创建仓库</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建仓库 store/index.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">&quot;redux&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">&quot;./reducer&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(reducer);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义reducer  store/reducer</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> actionTypes <span class="keyword">from</span> <span class="string">&quot;./constants&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initialState = &#123;</span><br><span class="line">  <span class="attr">counter</span>: <span class="number">0</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">reducer</span> = (<span class="params">state = initialState, action</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> actionTypes.<span class="property">ADD_NUMBER</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        <span class="attr">counter</span>: state.<span class="property">counter</span> + action.<span class="property">num</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">    <span class="keyword">case</span> actionTypes.<span class="property">SUB_NUMBER</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        <span class="attr">counter</span>: state.<span class="property">counter</span> - action.<span class="property">num</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> reducer;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义action  store/actionCreators</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> actonTypes <span class="keyword">from</span> <span class="string">&quot;./constants&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">addNumberAction</span> = (<span class="params">num</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">type</span>: actonTypes.<span class="property">ADD_NUMBER</span>,</span><br><span class="line">    num,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">subNumberAction</span> = (<span class="params">num</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">type</span>: actonTypes.<span class="property">SUB_NUMBER</span>,</span><br><span class="line">    num,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义action类型常量  store/constants</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="variable constant_">ADD_NUMBER</span> = <span class="string">&#x27;add_number&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="variable constant_">SUB_NUMBER</span> = <span class="string">&#x27;sub_number&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>在组件中使用store</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">&quot;react-redux&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; addNumberAction, subNumberAction &#125; <span class="keyword">from</span> <span class="string">&quot;../store/actionCreators&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">About</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">calcCountChange</span>(<span class="params">num, isAdd</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (isAdd) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">props</span>.<span class="title function_">addNumber</span>(num);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">props</span>.<span class="title function_">subNumber</span>(num);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>About page &#123;this.props.counter&#125; <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123; this.calcCountChange(5, true)&#125;&#125; &gt;</span></span><br><span class="line"><span class="language-xml">          +5</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123; this.calcCountChange(5, false)&#125;&#125;&gt;</span></span><br><span class="line"><span class="language-xml">          -5</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 映射状态到属性</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">mapStateToProps</span> = (<span class="params">state</span>) =&gt; (&#123; <span class="attr">counter</span>: state.<span class="property">counter</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 映射派发到属性</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">mapDispatchToProps</span> = (<span class="params">dispatch</span>) =&gt; (&#123;</span><br><span class="line">  <span class="attr">addNumber</span>: <span class="function">(<span class="params">num</span>) =&gt;</span> <span class="title function_">dispatch</span>(<span class="title function_">addNumberAction</span>(num)),</span><br><span class="line">  <span class="attr">subNumber</span>: <span class="function">(<span class="params">num</span>) =&gt;</span> <span class="title function_">dispatch</span>(<span class="title function_">subNumberAction</span>(num)),</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// connect的返回值是一个 高阶函数</span></span><br><span class="line"><span class="comment">// 将store和组件关联起来</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">connect</span>(mapStateToProps, mapDispatchToProps)(<span class="title class_">About</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在组件最外层包裹上provider，这样所有仓库都可以使用store</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&quot;react-dom/client&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Provider</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-redux&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;./store&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&quot;./App&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>));</span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="redux中异步网络请求的操作"><a href="#redux中异步网络请求的操作" class="headerlink" title="redux中异步网络请求的操作"></a>redux中异步网络请求的操作</h3><p>需要使用中间件  <code>npm i redux-thunk</code> 这样dispatch就可以派发函数了</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store/index</span></span><br><span class="line"><span class="keyword">import</span> &#123; createStore, applyMiddleware &#125; <span class="keyword">from</span> <span class="string">&quot;redux&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 增强中间件</span></span><br><span class="line"><span class="keyword">import</span> &#123;thunk&#125; <span class="keyword">from</span> <span class="string">&quot;redux-thunk&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">&quot;./reducer&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(reducer, <span class="title function_">applyMiddleware</span>(thunk));</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br><span class="line"></span><br><span class="line"><span class="comment">// store/actionCreators</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">changeBannersAction</span> = (<span class="params">banners</span>) =&gt; (&#123;</span><br><span class="line">  <span class="attr">type</span>: actonTypes.<span class="property">BANNER_LIST</span>,</span><br><span class="line">  banners,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">fetchMuldataAction</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">dispatch, getState</span>) =&gt;</span> &#123;</span><br><span class="line">    axios.<span class="title function_">get</span>(<span class="string">&quot;http://123.207.32.32:8000/home/multidata&quot;</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> banners = res.<span class="property">data</span>.<span class="property">data</span>.<span class="property">banner</span>.<span class="property">list</span>;</span><br><span class="line">      <span class="title function_">dispatch</span>(<span class="title function_">changeBannersAction</span>(banners));</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="redux调试工具"><a href="#redux调试工具" class="headerlink" title="redux调试工具"></a>redux调试工具</h3><p><code>react-devtoos 和 redux-devtool</code></p>
<p>redux-devtool只在开发环境中开启，在生产环境中要关闭</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store/index.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; createStore, applyMiddleware, compose &#125; <span class="keyword">from</span> <span class="string">&quot;redux&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">&quot;./reducer&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用中间件</span></span><br><span class="line"><span class="keyword">import</span> &#123; thunk &#125; <span class="keyword">from</span> <span class="string">&quot;redux-thunk&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置 redux-devtools</span></span><br><span class="line"><span class="keyword">const</span> composeEnhancers =</span><br><span class="line">  <span class="variable language_">window</span>.<span class="title function_">__REDUX_DEVTOOLS_EXTENSION_COMPOSE__</span>(&#123; <span class="attr">trace</span>: <span class="literal">true</span> &#125;) || compose;</span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(reducer, <span class="title function_">composeEnhancers</span>(<span class="title function_">applyMiddleware</span>(thunk)));</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="redux-toolkit"><a href="#redux-toolkit" class="headerlink" title="redux-toolkit"></a>redux-toolkit</h3><h4 id="认识redux-toolkit"><a href="#认识redux-toolkit" class="headerlink" title="认识redux-toolkit"></a>认识redux-toolkit</h4><p>Redux Toolkit 是官方推荐的编写 Redux 逻辑的方法。</p>
<ul>
<li>redux的编写逻辑过于的繁琐和麻烦。 并且代码通常分拆在多个文件中（虽然也可以放到一个文件管理，但是代码量过多，不利于管理）；</li>
<li>Redux Toolkit包旨在成为编写Redux逻辑的标准方式，从而解决上面提到的问题；</li>
<li>在很多地方为了称呼方便，也将之称为“RTK”；</li>
<li>安装Redux Toolkit：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @reduxjs/toolkit react-redux</span><br></pre></td></tr></table></figure>

<ul>
<li>Redux Toolkit的核心API主要是如下几个：<ul>
<li><font color="red">configureStore</font>：包装createStore以提供简化的配置选项和良好的默认值。它可以自动组合你的 slice reducer，添加你提供 的任何 Redux 中间件，redux-thunk默认包含，并启用 Redux DevTools Extension。</li>
<li><font color="red">createSlice</font>：接受reducer函数的对象、切片名称和初始状态值，并自动生成切片reducer，并带有相应的actions。</li>
<li><font color="red">createAsyncThunk</font>: 接受一个动作类型字符串和一个返回承诺的函数，并生成一个pending&#x2F;fulfilled&#x2F;rejected基于该承诺分 派动作类型的 thunk</li>
</ul>
</li>
</ul>
<h4 id="使用-1"><a href="#使用-1" class="headerlink" title="使用"></a>使用</h4><p>创建reducer</p>
<p>通过<code>createSlice</code>创建一个slice。</p>
<p><font color="red">createSlice</font>主要包含如下几个参数：</p>
<ul>
<li><font color="red">name</font>：用户标记slice的名词  在之后的redux-devtool中会显示对应的名词；</li>
<li><font color="red">initialState</font>：初始化值，第一次初始化时的值；</li>
<li><font color="red">reducers</font>：相当于之前的reducer函数<ul>
<li>对象类型，并且可以添加很多的函数；</li>
<li>函数类似于redux原来reducer中的一个case语句；</li>
<li>函数的参数：<ul>
<li>参数一：state</li>
<li>参数二：调用这个action时，传递的action参数；</li>
</ul>
</li>
</ul>
</li>
<li>createSlice返回值是一个对象，包含所有的actions；</li>
</ul>
<p>创建store</p>
<p><strong>configureStore用于创建store对象</strong>，常见参数如下：</p>
<ul>
<li><font color="red">reducer</font>，将slice中的reducer可以组成一个对象传入此处；</li>
<li><font color="red">middleware</font>：可以使用参数，传入其他的中间件（自行了解）；</li>
<li><font color="red">devTools</font>：是否配置devTools工具，默认为true；</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store/features/counter.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; createSlice &#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> counterSlice = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;counter&quot;</span>,</span><br><span class="line">  <span class="attr">initialState</span>: &#123;</span><br><span class="line">    <span class="attr">counter</span>: <span class="number">888</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">reducers</span>: &#123;</span><br><span class="line">    <span class="title function_">addNumber</span>(<span class="params">state, &#123; payload &#125;</span>) &#123;</span><br><span class="line">      state.<span class="property">counter</span> += payload;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">subNumber</span>(<span class="params">state, &#123; payload &#125;</span>) &#123;</span><br><span class="line">      state.<span class="property">counter</span> -= payload;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; addNumber, subNumber &#125; = counterSlice.<span class="property">actions</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> counterSlice.<span class="property">reducer</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// store/index.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; configureStore &#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> counterSlice <span class="keyword">from</span> <span class="string">&quot;./features/counter&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">configureStore</span>(&#123;</span><br><span class="line">  <span class="attr">reducer</span>: &#123;</span><br><span class="line">    <span class="attr">counter</span>: counterSlice,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&quot;react-dom/client&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Provider</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-redux&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;./store&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&quot;./App&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>));</span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="异步操作"><a href="#异步操作" class="headerlink" title="异步操作"></a>异步操作</h4><p>Redux Toolkit默认已经给我们继承了Thunk相关的功能：<code>createAsyncThunk</code></p>
<p>当createAsyncThunk创建出来的action被dispatch时，会存在三种状态：</p>
<ul>
<li><font color="red">pending</font>：action被发出，但是还没有最终的结果；</li>
<li><font color="red">fulfilled</font>：获取到最终的结果（有返回值的结果）；</li>
<li><font color="red">rejected</font>：执行过程中有错误或者抛出了异常；</li>
</ul>
<p>我们可以在createSlice的entraReducer中监听这些结果</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store/features/banner.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; createAsyncThunk, createSlice &#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getHomeData = <span class="title function_">createAsyncThunk</span>(</span><br><span class="line">  <span class="string">&quot;homeData&quot;</span>,</span><br><span class="line">  <span class="keyword">async</span> (extraInfo,store) =&gt; &#123;</span><br><span class="line">      <span class="comment">// extraInfo:调用这个方法时传入的参数，</span></span><br><span class="line">      <span class="comment">// store：当前的仓库</span></span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">&quot;http://123.207.32.32:8000/home/multidata&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> res.<span class="property">data</span>;</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> bannerSlice = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;banner&quot;</span>,</span><br><span class="line">  <span class="attr">initialState</span>: &#123;</span><br><span class="line">    <span class="attr">banners</span>: [],</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 同步操作</span></span><br><span class="line">  <span class="attr">reducers</span>: &#123;&#125;,</span><br><span class="line">  <span class="comment">// 异步操作</span></span><br><span class="line">    <span class="comment">// 这种写法已被废弃</span></span><br><span class="line">  <span class="comment">// extraReducers: &#123;</span></span><br><span class="line">  <span class="comment">//   [getHomeData.pending](state, action) &#123;</span></span><br><span class="line">  <span class="comment">//     console.log(&quot;getHomeData pending&quot;, action);</span></span><br><span class="line">  <span class="comment">//   &#125;,</span></span><br><span class="line">  <span class="comment">//   [getHomeData.fulfilled](state, action) &#123;</span></span><br><span class="line">  <span class="comment">//     console.log(&quot;getHomeData fulfilled&quot;, action);</span></span><br><span class="line">  <span class="comment">//   &#125;,</span></span><br><span class="line">  <span class="comment">//   [getHomeData.rejected](state, action) &#123;</span></span><br><span class="line">  <span class="comment">//     console.log(&quot;getHomeData rejected&quot;, action);</span></span><br><span class="line">  <span class="comment">//   &#125;,</span></span><br><span class="line">  <span class="comment">// &#125;,</span></span><br><span class="line">  <span class="attr">extraReducers</span>: <span class="function">(<span class="params">build</span>) =&gt;</span> &#123;</span><br><span class="line">    build</span><br><span class="line">      .<span class="title function_">addCase</span>(getHomeData.<span class="property">pending</span>, <span class="function">(<span class="params">state, action</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;getHomeData pending&quot;</span>, action);</span><br><span class="line">      &#125;)</span><br><span class="line">      .<span class="title function_">addCase</span>(getHomeData.<span class="property">fulfilled</span>, <span class="function">(<span class="params">state, action</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;getHomeData fulfilled&quot;</span>, action);</span><br><span class="line">        state.<span class="property">banners</span> = action.<span class="property">payload</span>.<span class="property">data</span>.<span class="property">banner</span>.<span class="property">list</span>;</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> bannerSlice.<span class="property">reducer</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i react-router-dom</span><br></pre></td></tr></table></figure>

<h3 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h3><p>react-router最主要的API是给我们提供的一些组件：</p>
<p><code>BrowserRouter</code>或<code>HashRouter</code></p>
<ul>
<li><font color="red">BrowserRouter</font>使用history模式；</li>
<li><font color="red">HashRouter</font>使用hash模式；</li>
</ul>
<h3 id="路由映射配置"><a href="#路由映射配置" class="headerlink" title="路由映射配置"></a>路由映射配置</h3><ul>
<li><code>Routes</code>：包裹所有的Route，在其中匹配一个路由<ul>
<li>Router5.x使用的是Switch组件</li>
</ul>
</li>
<li><code>Route</code>：Route用于路径的匹配；<ul>
<li><font color="red">path</font>属性：用于设置匹配到的路径；</li>
<li><font color="red">element</font>属性：设置匹配到路径后，渲染的组件；<ul>
<li>Router5.x使用的是component属性</li>
</ul>
</li>
<li>exact：精准匹配，只有精准匹配到完全一致的路径，才会渲染对应的组件；<ul>
<li>Router6.x不再支持该属性</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Routes</span>&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">Home</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/home&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">Home</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/about&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">About</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line">&lt;/<span class="title class_">Routes</span>&gt;</span><br></pre></td></tr></table></figure>

<h3 id="路由配置和跳转"><a href="#路由配置和跳转" class="headerlink" title="路由配置和跳转"></a>路由配置和跳转</h3><p>Link和NavLink：</p>
<ul>
<li>通常路径的跳转是使用Link组件，最终会被渲染成a元素；</li>
<li>NavLink是在Link基础之上增加了一些样式属性（后续学习）；</li>
<li>to属性：Link中最重要的属性，用于设置跳转到的路径；</li>
</ul>
<h3 id="NavLink的使用"><a href="#NavLink的使用" class="headerlink" title="NavLink的使用"></a>NavLink的使用</h3><p>需求：路径选中时，对应的a元素变为红色</p>
<p>这个时候，我们要使用NavLink组件来替代Link组件：</p>
<ul>
<li><font color="red">style</font>：传入函数，函数接受一个对象，包含isActive属性</li>
<li><font color="red">className</font>：传入函数，函数接受一个对象，包含isActive属性</li>
</ul>
<p>默认的activeClassName：</p>
<p>事实上在默认匹配成功时，NavLink就会添加上一个动态的active class；</p>
<p>当然，如果你担心这个class在其他地方被使用了，出现样式的层叠，也可以自定义class</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Link</span>, <span class="title class_">NavLink</span>, <span class="title class_">Route</span>, <span class="title class_">Routes</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&quot;./pages/Home&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">About</span> <span class="keyword">from</span> <span class="string">&quot;./pages/About&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;./app.css&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;header&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>Header<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;nav&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;/* 使用Link */&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&#123;</span>&quot;/<span class="attr">home</span>&quot;&#125;&gt;</span>Home<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&#123;</span>&quot;/<span class="attr">about</span>&quot;&#125;&gt;</span>About<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">            &#123;/* 默认active类名 */&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">NavLink</span> <span class="attr">to</span>=<span class="string">&#123;</span>&quot;/<span class="attr">home</span>&quot;&#125;&gt;</span>Home<span class="tag">&lt;/<span class="name">NavLink</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">NavLink</span> <span class="attr">to</span>=<span class="string">&#123;</span>&quot;/<span class="attr">about</span>&quot;&#125;&gt;</span>About<span class="tag">&lt;/<span class="name">NavLink</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">            &#123;/* 动态style */&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">NavLink</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">to</span>=<span class="string">&quot;/home&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">style</span>=<span class="string">&#123;(&#123;</span> <span class="attr">isActive</span> &#125;) =&gt;</span> (&#123; color: isActive ? &quot;red&quot; : &quot;&quot; &#125;)&#125;</span></span><br><span class="line"><span class="language-xml">            &gt;</span></span><br><span class="line"><span class="language-xml">              Home</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">NavLink</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">NavLink</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">to</span>=<span class="string">&quot;/about&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">style</span>=<span class="string">&#123;(&#123;</span> <span class="attr">isActive</span> &#125;) =&gt;</span> (&#123; color: isActive ? &quot;red&quot; : &quot;&quot; &#125;)&#125;</span></span><br><span class="line"><span class="language-xml">            &gt;</span></span><br><span class="line"><span class="language-xml">              About</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">NavLink</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">            &#123;/* 动态className */&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">NavLink</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">to</span>=<span class="string">&quot;/home&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">className</span>=<span class="string">&#123;(&#123;</span> <span class="attr">isActive</span> &#125;) =&gt;</span> (isActive ? &quot;link-active&quot; : &quot;&quot;)&#125;</span></span><br><span class="line"><span class="language-xml">            &gt;</span></span><br><span class="line"><span class="language-xml">              Home</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">NavLink</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">NavLink</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">to</span>=<span class="string">&quot;/about&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">className</span>=<span class="string">&#123;(&#123;</span> <span class="attr">isActive</span> &#125;) =&gt;</span> (isActive ? &quot;link-active&quot; : &quot;&quot;)&#125;</span></span><br><span class="line"><span class="language-xml">            &gt;</span></span><br><span class="line"><span class="language-xml">              About</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">NavLink</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">Home</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/home&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">Home</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/about&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">About</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;footer&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">          Footer</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Navigate导航"><a href="#Navigate导航" class="headerlink" title="Navigate导航"></a>Navigate导航</h3><p><font color="red">Navigate</font>用于路由的重定向，当这个组件出现时，就会执行跳转到对应的to路径中</p>
<p>我们可以在匹配到&#x2F;的时候，直接跳转到&#x2F;home页面</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Route</span> path=<span class="string">&quot;/&quot;</span> element=&#123;<span class="language-xml"><span class="tag">&lt;<span class="name">Navigate</span> <span class="attr">to</span>=<span class="string">&quot;/home&quot;</span> /&gt;</span></span>&#125; /&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Not-Found页面配置"><a href="#Not-Found页面配置" class="headerlink" title="Not Found页面配置"></a>Not Found页面配置</h3><ul>
<li>开发一个Not Found页面；</li>
<li>配置对应的Route，并且设置path为*即可；</li>
</ul>
<p>放在路由配置的最后一行</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Route</span> path=<span class="string">&quot;*&quot;</span> element=&#123;<span class="language-xml"><span class="tag">&lt;<span class="name">NotFound</span> /&gt;</span></span>&#125; /&gt;</span><br></pre></td></tr></table></figure>

<h3 id="路由的嵌套"><a href="#路由的嵌套" class="headerlink" title="路由的嵌套"></a>路由的嵌套</h3><p><code>&lt;Outlet /&gt;</code>组件用于在父路由元素中作为子路由的占位元素。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Route</span> path=<span class="string">&quot;/home&quot;</span> element=&#123;<span class="language-xml"><span class="tag">&lt;<span class="name">Home</span> /&gt;</span></span>&#125;&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/home&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">Navigate</span> <span class="attr">to</span>=<span class="string">&quot;/home/recommend&quot;</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/home/recommend&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">HomeRecommend</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line">&lt;/<span class="title class_">Route</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Home.jsx</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">Home</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Home Page<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/home/recommend&quot;</span>&gt;</span>推荐<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Outlet</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="手动路由的跳转"><a href="#手动路由的跳转" class="headerlink" title="手动路由的跳转"></a>手动路由的跳转</h3><blockquote>
<p>在Router6.x版本之后，代码类的API都迁移到了hooks的写法</p>
</blockquote>
<p>如果我们希望进行代码跳转，需要通过<code>useNavigate</code>的Hook获取到<font color="red">navigate对象</font>进行操作；</p>
<p>函数式组件直接使用hook即可</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Outlet</span>, useNavigate &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Home</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">navigateTo</span>(<span class="params">path</span>) &#123;</span><br><span class="line">    <span class="title function_">navigate</span>(path);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Home Page<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> navigateTo(&quot;/home/songMenu&quot;)&#125;&gt;歌单<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Outlet</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那么如果是一个函数式组件，我们可以直接调用，但是如果是一个类组件呢？</p>
<p><strong>封装高阶组件，实现类组件的路由跳转</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  useLocation,</span><br><span class="line">  useNavigate,</span><br><span class="line">  useParams,</span><br><span class="line">  useSearchParams,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 自定义高阶组件实现路由跳转</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">withRouter</span>(<span class="params">WrapperComponent</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="comment">// 导航</span></span><br><span class="line">    <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 动态路由参数</span></span><br><span class="line">    <span class="keyword">const</span> params = <span class="title function_">useParams</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 查询字符串参数</span></span><br><span class="line">    <span class="keyword">const</span> location = <span class="title function_">useLocation</span>(); <span class="comment">// 不推荐得到的结果是/name=xxx&amp;age=xxx</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> [searchParams] = <span class="title function_">useSearchParams</span>();</span><br><span class="line">    <span class="keyword">const</span> query = <span class="title class_">Object</span>.<span class="title function_">fromEntries</span>(searchParams);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> router = &#123; navigate, params, location,query &#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">WrapperComponent</span> &#123;<span class="attr">...props</span>&#125; <span class="attr">router</span>=<span class="string">&#123;router&#125;</span> /&gt;</span></span>;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> withRouter;</span><br></pre></td></tr></table></figure>

<h3 id="路由参数跳转"><a href="#路由参数跳转" class="headerlink" title="路由参数跳转"></a>路由参数跳转</h3><ol>
<li>动态路由的方式；</li>
<li>search传递参数</li>
</ol>
<h4 id="动态路由"><a href="#动态路由" class="headerlink" title="动态路由"></a>动态路由</h4><p><code>/:id</code> ：类似这种写法</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Route</span> path=<span class="string">&quot;/home/songMenu/detail/:id&quot;</span> element=&#123;<span class="language-xml"><span class="tag">&lt;<span class="name">Detail</span> /&gt;</span></span>&#125; /&gt;</span><br></pre></td></tr></table></figure>

<p>获取参数</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useNavigate, useParams &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> params = <span class="title function_">useParams</span>();</span><br></pre></td></tr></table></figure>

<h4 id="search传参"><a href="#search传参" class="headerlink" title="search传参"></a>search传参</h4><p><code>/user?name=why&amp;age=18</code></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 查询字符串参数</span></span><br><span class="line"><span class="keyword">const</span> location = <span class="title function_">useLocation</span>(); <span class="comment">// 不推荐得到的结果是/name=xxx&amp;age=xxx</span></span><br><span class="line"><span class="keyword">const</span> [searchParams] = <span class="title function_">useSearchParams</span>();</span><br><span class="line"><span class="keyword">const</span> query = <span class="title class_">Object</span>.<span class="title function_">fromEntries</span>(searchParams);</span><br></pre></td></tr></table></figure>

<h3 id="路由的配置文件"><a href="#路由的配置文件" class="headerlink" title="路由的配置文件"></a>路由的配置文件</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// router/index.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Navigate</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&quot;../pages/Home&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">HomeRecommend</span> <span class="keyword">from</span> <span class="string">&quot;../pages/HomeRecommend&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">NotFound</span> <span class="keyword">from</span> <span class="string">&quot;../pages/NotFound&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/&quot;</span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Navigate</span> <span class="attr">to</span>=<span class="string">&quot;/home&quot;</span> /&gt;</span></span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/home&quot;</span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Home</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&quot;/home&quot;</span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Navigate</span> <span class="attr">to</span>=<span class="string">&quot;/home/recommend&quot;</span> /&gt;</span></span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&quot;/home/recommend&quot;</span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">HomeRecommend</span> /&gt;</span></span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;*&quot;</span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">NotFound</span> /&gt;</span></span>,</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> routes;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>使用</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">``</span><span class="string">`</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">## react-hooks</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">### 为什么要使用hooks</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">类组件优点：</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">*   class组件可以定义自己的state，用来保存组件自己内部的状态</span></span><br><span class="line"><span class="string">*   class组件有自己的生命周期，我们可以在对应的生命周期中完成自己的逻辑；</span></span><br><span class="line"><span class="string">*   class组件可以在状态改变时只重新执行render函数以及我们希望重新调用的生命周期函数componentDidUpdate等</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">类组件的缺点：</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">*   复杂组件变得难以理解</span></span><br><span class="line"><span class="string">*   难以理解的class</span></span><br><span class="line"><span class="string">*   组件复用状态很难</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">### useState</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">useState&lt;font color=&quot;red&quot;&gt;接受唯一一个参数&lt;/font&gt;，在第一次组件被调用时使用来作为初始化值。（如果没有传递参数，那么初始化值为undefined）。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">useState的&lt;font color=&quot;red&quot;&gt;返回值是一个数组&lt;/font&gt;，我们可以通过数组的解构，来完成赋值会非常方便。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>jsx</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">changeCount</span>(<span class="params">num</span>) &#123;</span><br><span class="line">    <span class="title function_">setCount</span>(count + num)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>计数器：&#123;count&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> changeCount(10)&#125;&gt;+10<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br></pre></td></tr></table></figure>

<h3 id="useEffect-1"><a href="#useEffect-1" class="headerlink" title="useEffect"></a>useEffect</h3><p>Effect Hook 可以让你来完成一些类似于class中生命周期的功能；</p>
<p>useEffect<font color="red">要求我们传入一个回调函数</font>，在React<font color="red">执行完更新DOM操作之后，就会回调这个函数</font>；</p>
<p>默认情况下，无论是<font color="red">第一次渲染之后</font>，还是<font color="red">每次更新之后</font>，都会<font color="red">执行这个 回调函数</font>；</p>
<h4 id="清除副作用"><a href="#清除副作用" class="headerlink" title="清除副作用"></a>清除副作用</h4><p>在class组件的编写过程中，某些副作用的代码，我们需要在componentWillUnmount中进行清除：</p>
<ul>
<li><p>比如我们之前的事件总线或Redux中手动调用subscribe；</p>
</li>
<li><p>都需要在componentWillUnmount有对应的取消订阅；</p>
</li>
</ul>
<p>useEffect传入的回调函数A本身可以有一个返回值，这个<font color="red">返回值是另外一个回调函数B</font>：</p>
<p>React 何时清除 effect？</p>
<ul>
<li><p>React 会在组件更新和卸载的时候执行清除操作；</p>
</li>
<li><p>正如之前学到的，effect 在每次渲染的时候都会执行；</p>
</li>
</ul>
<h4 id="用法-1"><a href="#用法-1" class="headerlink" title="用法"></a>用法</h4><blockquote>
<p>引入useEffect</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1. didMount 第二个参数传一个空数组</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;,[]);</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2. didMount + didUpdate</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;,[state | props])</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 3. didMount + 监听所有的state和所有的props</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;);<span class="comment">// 不传第二个参数</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 4. willUnmount</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">()=&gt;</span>&#123;<span class="comment">//didMount</span></span><br><span class="line">    <span class="comment">// 应用 ：设置定时器</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="comment">//willUnmount</span></span><br><span class="line">        <span class="comment">// 清空定时器</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;,[]);</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; memo, useEffect, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span> = <span class="title function_">memo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>)</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">title</span> = count</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;监听redux&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;取消监听&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>当前计数：&#123;count&#125; <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setCount(count + 1)&#125;&gt;+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br></pre></td></tr></table></figure>

<h4 id="多次使用effect"><a href="#多次使用effect" class="headerlink" title="多次使用effect"></a>多次使用effect</h4><p>Hook 允许我们按照代码的用途分离它们， 而不是像生命周期函数那样：</p>
<ul>
<li>React 将按照 effect 声明的顺序依次调用组件中的每一个 effect；</li>
</ul>
<h4 id="effect性能优化"><a href="#effect性能优化" class="headerlink" title="effect性能优化"></a>effect性能优化</h4><p>默认情况下，useEffect的回调函数会在每次渲染时都重新执行，但是这会导致两个问题：</p>
<ul>
<li>某些代码我们只是希望执行一次即可，类似于componentDidMount和componentWillUnmount中完成的事情；（比如网 络请求、订阅和取消订阅）；</li>
<li>另外，多次执行也会导致一定的性能问题；</li>
</ul>
<p>我们如何决定useEffect在什么时候应该执行和什么时候不应该执行呢？</p>
<p>useEffect实际上有两个参数：</p>
<p>参数一：执行的<font color="red">回调函数</font>；</p>
<p>参数二：该useEffect<font color="red">在哪些state发生变化时，才重新执行</font>；（受谁的影响）</p>
<p>但是，如果一个函数我们不希望依赖任何的内容时，也可以<font color="red">传入一个空的数组 []</font>：</p>
<ul>
<li>那么这里的两个回调函数分别对应的就是componentDidMount和componentWillUnmount生命周期函数了；</li>
</ul>
<h3 id="useContext-1"><a href="#useContext-1" class="headerlink" title="useContext"></a>useContext</h3><p>用于数据共享</p>
<p>使用：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// context/index</span></span><br><span class="line"><span class="keyword">import</span> &#123; createContext &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">UserContext</span> = <span class="title function_">createContext</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ThemeContext</span> = <span class="title function_">createContext</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; <span class="title class_">UserContext</span>, <span class="title class_">ThemeContext</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&quot;react-dom/client&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">UserContext</span>, <span class="title class_">ThemeContext</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./03.useContext的使用/context/index&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&quot;./03.useContext的使用/App&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>));</span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">UserContext.Provider</span> <span class="attr">value</span>=<span class="string">&#123;&#123;</span> <span class="attr">name:</span> &quot;<span class="attr">cr</span>&quot;, <span class="attr">age:</span> <span class="attr">22</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">ThemeContext.Provider</span> <span class="attr">value</span>=<span class="string">&#123;&#123;</span> <span class="attr">color:</span> &quot;<span class="attr">red</span>&quot;, <span class="attr">fontSize:</span> <span class="attr">30</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">ThemeContext.Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">UserContext.Provider</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// App.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; memo, useContext &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">UserContext</span>, <span class="title class_">ThemeContext</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./context/index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span> = <span class="title function_">memo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> user = <span class="title function_">useContext</span>(<span class="title class_">UserContext</span>)</span><br><span class="line">  <span class="keyword">const</span> theme = <span class="title function_">useContext</span>(<span class="title class_">ThemeContext</span>)</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span> &#123;user.name&#125; - &#123;user.age&#125; <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h3</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">color:</span> <span class="attr">theme.color</span>, <span class="attr">fontSize:</span> <span class="attr">theme.fontSize</span> &#125;&#125;&gt;</span>theme<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br></pre></td></tr></table></figure>

<h3 id="useCallback"><a href="#useCallback" class="headerlink" title="useCallback"></a>useCallback</h3><p>用于性能优化</p>
<p>如何进行性能的优化呢？</p>
<ul>
<li>useCallback会<font color="red">返回一个函数的 memoized（记忆的） 值</font>；</li>
<li>在<font color="red">依赖不变的情况下，多次定义的时候，返回的值是相同的</font>；</li>
</ul>
<p>通常使用useCallback的目的是<font color="red">不希望子组件进行多次渲染</font>，并不是为了函数进行缓存；</p>
<blockquote>
<p>理解：</p>
<p>当需要将一个函数传递给子组件时，最好使用useCallback进行优化，将优化之后的函数传递给子组件</p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; memo, useCallback, useRef, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="comment">// Home组件</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Home</span> = <span class="title function_">memo</span>(<span class="function">(<span class="params">props</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; increament &#125; = props</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Home重新渲染&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;increament&#125;</span>&gt;</span>home+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span> = <span class="title function_">memo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [couter, setCouter] = <span class="title function_">useState</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [msg, setMsg] = <span class="title function_">useState</span>(<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 优化1: 注意要监听couter，否则会出现闭包陷阱，increament函数会失效</span></span><br><span class="line">  <span class="comment">// const increament = useCallback(() =&gt; &#123;</span></span><br><span class="line">  <span class="comment">//   setCouter(couter + 1)</span></span><br><span class="line">  <span class="comment">//   console.log(&#x27;increament&#x27;);</span></span><br><span class="line">  <span class="comment">// &#125;, [couter])</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 优化2：使用useRef，在组件多次渲染时，返回的是同一个值</span></span><br><span class="line">  <span class="keyword">const</span> couterRef = <span class="title function_">useRef</span>()</span><br><span class="line">  couterRef.<span class="property">current</span> = couter</span><br><span class="line">  <span class="keyword">const</span> increament = <span class="title function_">useCallback</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">setCouter</span>(couterRef.<span class="property">current</span> + <span class="number">1</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;increament&#x27;</span>);</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>计数: &#123;couter&#125; <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;increament&#125;</span>&gt;</span>+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Home</span> <span class="attr">increament</span>=<span class="string">&#123;increament&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Home</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>msg:&#123;msg&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setMsg(Math.random())&#125;&gt;修改msg<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br></pre></td></tr></table></figure>

<h3 id="useMemo"><a href="#useMemo" class="headerlink" title="useMemo"></a>useMemo</h3><p>性能优化</p>
<p>和useCallback的区别：</p>
<ul>
<li>useCallback是对传入的函数进行优化，useMemo是对函数的返回值进行优化的</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">useCallback</span>(fn,depc)  =&gt; <span class="title function_">useMemo</span>(<span class="function">()=&gt;</span>fn,depc)</span><br></pre></td></tr></table></figure>

<p>使用时机：</p>
<ol>
<li>进行大量的计算操作，是否有必须要每次渲染时都重新计算；</li>
<li>对子组件传递相同内容的对象时，使用useMemo进行性能的优化</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; memo, useMemo, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">totalCount</span> = (<span class="params">num</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> total = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt;= num; i++) &#123;</span><br><span class="line">    total += i</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;执行了&#x27;</span>);</span><br><span class="line">  <span class="keyword">return</span> total</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span> = <span class="title function_">memo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [couter, setCouter] = <span class="title function_">useState</span>(<span class="number">0</span>)</span><br><span class="line">  <span class="comment">// 不使用useMemo的话，会导致totalCount执行多次</span></span><br><span class="line">  <span class="keyword">const</span> resultNum = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">totalCount</span>(<span class="number">50</span>)</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>计算总数：&#123;resultNum&#125; <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;couter&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setCouter(couter + 1)&#125;&gt;+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br></pre></td></tr></table></figure>

<h3 id="useRef-1"><a href="#useRef-1" class="headerlink" title="useRef"></a>useRef</h3><p>useRef返回一个ref对象，返回的ref对象再组件的整个生命周期保持不变</p>
<p>最常用的ref是两种用法</p>
<ul>
<li>引入DOM（或者组件，但是需要是class组件）元素；</li>
<li>保存一个数据，这个对象在整个生命周期中可以保存不变</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">useRef</span>: 用于得到组件中的某个<span class="variable constant_">DOM</span>元素</span><br><span class="line"><span class="number">1.</span> 使用useRef创建用于存储input元素的容器对象(内部使用current属性存储)</span><br><span class="line"><span class="number">2.</span> 将ref容器通过ref属性交给表单项标签 =&gt; 渲染时内部会将对应的input元素保存到ref容器的current属性上</span><br><span class="line"><span class="number">3.</span> 点击提交按钮时, 通过ref容器的current属性得到input <span class="variable constant_">DOM</span>元素 =&gt; 就可以读取其value了</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 函数组件使用ref：forwardRef</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; forwardRef, memo, useRef &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Home</span> = <span class="title function_">memo</span>(<span class="title function_">forwardRef</span>(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">ref</span>=<span class="string">&#123;ref&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span> = <span class="title function_">memo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> inputRef = <span class="title function_">useRef</span>()</span><br><span class="line">  <span class="keyword">const</span> homeRef = <span class="title function_">useRef</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onFocus</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(homeRef.<span class="property">current</span>);</span><br><span class="line">    homeRef.<span class="property">current</span>.<span class="title function_">focus</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Home</span> <span class="attr">ref</span>=<span class="string">&#123;homeRef&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;onFocus&#125;</span>&gt;</span>获取焦点<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br></pre></td></tr></table></figure>

<h3 id="useImperativeHandle"><a href="#useImperativeHandle" class="headerlink" title="useImperativeHandle"></a>useImperativeHandle</h3><p>类比vue中的defineExpose，useRef作用在子组件上后，可以拿到子组件中的所有数据，为了安全考虑使用<code>useImperativeHandle</code></p>
<p>forwardRef的做法本身没有什么问题，但是我们是将子组件的DOM直接暴露给了父组件：</p>
<ul>
<li>直接暴露给父组件带来的问题是某些情况的不可控；</li>
<li>父组件可以拿到DOM后进行任意的操作；</li>
<li>但是，我们只是希望父组件可以操作特定属性，其他并不希望它随意操作；</li>
</ul>
<p>通过<code>useImperativeHandle</code>可以值暴露固定的操作</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; forwardRef, memo, useImperativeHandle, useRef &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Home</span> = <span class="title function_">memo</span>(<span class="title function_">forwardRef</span>(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> inputRef = <span class="title function_">useRef</span>()</span><br><span class="line">  <span class="title function_">useImperativeHandle</span>(ref, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="title function_">focus</span>(<span class="params"></span>) &#123;</span><br><span class="line">        inputRef.<span class="property">current</span>.<span class="title function_">focus</span>()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">ref</span>=<span class="string">&#123;inputRef&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span> = <span class="title function_">memo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> homeRef = <span class="title function_">useRef</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onFocus</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(homeRef.<span class="property">current</span>);</span><br><span class="line">    homeRef.<span class="property">current</span>.<span class="title function_">focus</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Home</span> <span class="attr">ref</span>=<span class="string">&#123;homeRef&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;onFocus&#125;</span>&gt;</span>获取焦点<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br></pre></td></tr></table></figure>

<h3 id="useLayoutEffect"><a href="#useLayoutEffect" class="headerlink" title="useLayoutEffect"></a>useLayoutEffect</h3><p>useLayoutEffect看起来和useEffect非常的相似，事实上他们也只有一点区别而已：</p>
<ul>
<li><p>useEffect会在渲染的内容更新到DOM上后执行，不会阻塞DOM的更新；</p>
</li>
<li><p>useLayoutEffect会在渲染的内容更新到DOM上之前执行，会阻塞DOM的更新；</p>
</li>
</ul>
<p>如果我们希望在某些操作发生之后再更新DOM，那么应该将这个操作放到useLayoutEffect。</p>
<blockquote>
<p>官方更推荐useEffect</p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; memo, useEffect, useLayoutEffect, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span> = <span class="title function_">memo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 使用useEffect修改值 会闪烁</span></span><br><span class="line">  <span class="comment">// useEffect(() =&gt; &#123;</span></span><br><span class="line">  <span class="comment">//   if (count === 0) &#123;</span></span><br><span class="line">  <span class="comment">//     setCount(Math.random() + 99)</span></span><br><span class="line">  <span class="comment">//   &#125;</span></span><br><span class="line">  <span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">useLayoutEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (count === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="title function_">setCount</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() + <span class="number">99</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;count&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setCount(0)&#125;&gt;修改<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br></pre></td></tr></table></figure>

<h3 id="自定义hook"><a href="#自定义hook" class="headerlink" title="自定义hook"></a>自定义hook</h3><p>自定义Hook本质上只是一种函数代码逻辑的抽取，严格意义上来说，它本身并不算React的特性</p>
<p><font color="red">注意：使用use开头</font></p>
<p>案例：获取滚动的位置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">useScrollPosition</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">scrollFn</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">window</span>.<span class="property">scrollX</span>, <span class="variable language_">window</span>.<span class="property">scrollY</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;scroll&quot;</span>, scrollFn);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 销毁时取消监听</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&quot;scroll&quot;</span>, scrollFn);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;, []);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useScrollPosition;</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://old-gang.github.io">Mr.储</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://old-gang.github.io/post/d9de3b24.html">https://old-gang.github.io/post/d9de3b24.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://old-gang.github.io" target="_blank">Mr.储</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/web%E5%89%8D%E7%AB%AF/">web前端</a></div><div class="post_share"><div class="social-share" data-image="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/post/e466bd65.html"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">云服务器</div></div></a></div><div class="next-post pull-right"><a href="/post/aff26c96.html"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">服务端渲染</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Mr.储</div><div class="author-info__description">Fake it, until u make it~</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">20</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/old-gang"><i class="fab fa-github"></i><span>点个关注呗</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/old-gang" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content"><p align="center"><img src="https://chu-image-host.oss-cn-beijing.aliyuncs.com/typora/f7384c88956d4378b72e47548e19c9f8.gif" width="50" alt="gou"></p> <p align="center">微信号：cr1710518304</p> <p align="center">QQ号：1710518304</p></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A4%E8%AF%86React"><span class="toc-number">1.</span> <span class="toc-text">认识React</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#React-%E6%A6%82%E8%BF%B0"><span class="toc-number">1.1.</span> <span class="toc-text">React 概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#React-%E4%B8%89%E4%B8%AA%E7%89%B9%E7%82%B9"><span class="toc-number">1.2.</span> <span class="toc-text">React 三个特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#React-%E5%BC%80%E5%8F%91%E7%9A%84%E7%BD%91%E7%AB%99"><span class="toc-number">1.3.</span> <span class="toc-text">React 开发的网站</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85VSCode%E6%8F%92%E4%BB%B6"><span class="toc-number">1.4.</span> <span class="toc-text">安装VSCode插件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#React%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">2.</span> <span class="toc-text">React基本使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4"><span class="toc-number">2.1.</span> <span class="toc-text">基本使用步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E5%B1%9E%E6%80%A7"><span class="toc-number">2.2.</span> <span class="toc-text">特殊属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%8D%E6%9D%A5%E4%B8%AA%E5%A4%8D%E6%9D%82%E7%82%B9%E7%9A%84"><span class="toc-number">2.3.</span> <span class="toc-text">再来个复杂点的</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%90%86%E8%A7%A3-React-%E5%85%83%E7%B4%A0"><span class="toc-number">2.4.</span> <span class="toc-text">理解 React 元素</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JSX"><span class="toc-number">3.</span> <span class="toc-text">JSX</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%90%86%E8%A7%A3%E5%92%8C%E4%BD%BF%E7%94%A8"><span class="toc-number">3.1.</span> <span class="toc-text">基本理解和使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JSX%E4%B8%AD%E4%BD%BF%E7%94%A8-JS-%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">3.2.</span> <span class="toc-text">JSX中使用 JS 表达式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E6%B8%B2%E6%9F%93"><span class="toc-number">4.</span> <span class="toc-text">条件渲染</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#if%E2%80%A6else"><span class="toc-number">4.1.</span> <span class="toc-text">if…else</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E5%85%83%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">4.2.</span> <span class="toc-text">三元表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#amp-amp"><span class="toc-number">4.3.</span> <span class="toc-text">&amp;&amp;</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%97%E8%A1%A8%E6%B8%B2%E6%9F%93"><span class="toc-number">5.</span> <span class="toc-text">列表渲染</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%B7%E5%BC%8F%E5%A4%84%E7%90%86"><span class="toc-number">6.</span> <span class="toc-text">样式处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%8C%E5%86%85%E6%A0%B7%E5%BC%8F"><span class="toc-number">6.1.</span> <span class="toc-text">行内样式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E5%90%8D"><span class="toc-number">6.2.</span> <span class="toc-text">类名</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86"><span class="toc-number">7.</span> <span class="toc-text">事件处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%91%E5%AE%9A%E4%BA%8B%E4%BB%B6"><span class="toc-number">7.1.</span> <span class="toc-text">绑定事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1"><span class="toc-number">7.2.</span> <span class="toc-text">事件对象</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B"><span class="toc-number">8.</span> <span class="toc-text">案例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#React%E7%9A%84%E7%BB%84%E4%BB%B6"><span class="toc-number">9.</span> <span class="toc-text">React的组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E5%88%9B%E5%BB%BAReact%E9%A1%B9%E7%9B%AE"><span class="toc-number">10.</span> <span class="toc-text">快速创建React项目</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#react%E8%84%9A%E6%89%8B%E6%9E%B6%E4%BD%BF%E7%94%A8"><span class="toc-number">10.1.</span> <span class="toc-text">react脚手架使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAReact%E9%A1%B9%E7%9B%AE"><span class="toc-number">10.2.</span> <span class="toc-text">创建React项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8EV18%E9%99%8D%E7%BA%A7%E5%88%B0V17%E7%9A%84%E7%89%88%E6%9C%AC"><span class="toc-number">10.3.</span> <span class="toc-text">从V18降级到V17的版本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85chrome%E8%B0%83%E8%AF%95%E5%B7%A5%E5%85%B7"><span class="toc-number">10.4.</span> <span class="toc-text">安装chrome调试工具</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%BB%84%E4%BB%B6%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="toc-number">11.</span> <span class="toc-text">创建组件的两种方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E7%BB%84%E4%BB%B6"><span class="toc-number">11.1.</span> <span class="toc-text">函数组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E7%BB%84%E4%BB%B6"><span class="toc-number">11.2.</span> <span class="toc-text">类组件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E7%BB%84%E4%BB%B6%E7%9A%84%E7%8A%B6%E6%80%81-state"><span class="toc-number">12.</span> <span class="toc-text">类组件的状态 state</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#state%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">12.1.</span> <span class="toc-text">state的基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E5%9B%9E%E8%B0%83this%E9%97%AE%E9%A2%98"><span class="toc-number">12.2.</span> <span class="toc-text">事件回调this问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92"><span class="toc-number">12.3.</span> <span class="toc-text">参数传递</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#render%E5%87%BD%E6%95%B0%E6%B8%B2%E6%9F%93%E6%97%B6%E6%9C%BA"><span class="toc-number">12.4.</span> <span class="toc-text">render函数渲染时机</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E7%9A%84props"><span class="toc-number">13.</span> <span class="toc-text">组件的props</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8"><span class="toc-number">13.1.</span> <span class="toc-text">使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#props%E6%A0%A1%E9%AA%8C%E4%B8%8E%E9%BB%98%E8%AE%A4%E5%80%BC"><span class="toc-number">13.2.</span> <span class="toc-text">props校验与默认值</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%92%E6%A7%BD"><span class="toc-number">14.</span> <span class="toc-text">插槽</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%8F%92%E6%A7%BD"><span class="toc-number">14.1.</span> <span class="toc-text">基本插槽</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%9C%E7%94%A8%E5%9F%9F%E6%8F%92%E6%A7%BD"><span class="toc-number">14.2.</span> <span class="toc-text">作用域插槽</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E7%BB%84%E4%BB%B6%E7%9A%84ref"><span class="toc-number">15.</span> <span class="toc-text">类组件的ref</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%90%86%E8%A7%A3"><span class="toc-number">15.1.</span> <span class="toc-text">理解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E7%A0%81"><span class="toc-number">15.2.</span> <span class="toc-text">编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86-1"><span class="toc-number">15.3.</span> <span class="toc-text">事件处理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E7%BB%84%E4%BB%B6%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">16.</span> <span class="toc-text">类组件的生命周期</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%89%E5%A4%A7%E9%98%B6%E6%AE%B5"><span class="toc-number">16.1.</span> <span class="toc-text">生命周期三大阶段</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%82%E8%BD%BD%E9%98%B6%E6%AE%B5"><span class="toc-number">16.1.1.</span> <span class="toc-text">挂载阶段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E9%98%B6%E6%AE%B5"><span class="toc-number">16.1.2.</span> <span class="toc-text">更新阶段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%B8%E8%BD%BD%E9%98%B6%E6%AE%B5"><span class="toc-number">16.1.3.</span> <span class="toc-text">卸载阶段</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E9%92%A9%E5%AD%90"><span class="toc-number">16.2.</span> <span class="toc-text">生命周期钩子</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E5%B8%B8%E7%94%A8%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E9%92%A9%E5%AD%90"><span class="toc-number">16.3.</span> <span class="toc-text">不常用生命周期钩子</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A7%E7%89%88react%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F-%E7%BA%AF%E4%BA%86%E8%A7%A3"><span class="toc-number">16.4.</span> <span class="toc-text">旧版react生命周期(纯了解)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6"><span class="toc-number">17.</span> <span class="toc-text">高阶组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8"><span class="toc-number">17.1.</span> <span class="toc-text">应用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hooks"><span class="toc-number">18.</span> <span class="toc-text">Hooks</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#useState"><span class="toc-number">18.1.</span> <span class="toc-text">useState()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useEffect"><span class="toc-number">18.2.</span> <span class="toc-text">useEffect()</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%B3%95"><span class="toc-number">18.2.1.</span> <span class="toc-text">用法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useRef"><span class="toc-number">18.3.</span> <span class="toc-text">useRef</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useContext"><span class="toc-number">18.4.</span> <span class="toc-text">useContext</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hook%E8%A7%84%E5%88%99"><span class="toc-number">18.5.</span> <span class="toc-text">Hook规则:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%98%E6%96%B9-Hooks"><span class="toc-number">18.6.</span> <span class="toc-text">官方 Hooks</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%B6%E9%9B%86%E8%A1%A8%E5%8D%95%E6%95%B0%E6%8D%AE"><span class="toc-number">19.</span> <span class="toc-text">收集表单数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E5%8F%97%E6%8E%A7%E7%BB%84%E4%BB%B6"><span class="toc-number">19.1.</span> <span class="toc-text">非受控组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%97%E6%8E%A7%E7%BB%84%E4%BB%B6"><span class="toc-number">19.2.</span> <span class="toc-text">受控组件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B-TODO-List-%E6%A1%88%E4%BE%8B"><span class="toc-number">20.</span> <span class="toc-text">案例- TODO List 案例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ajax"><span class="toc-number">21.</span> <span class="toc-text">ajax</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%90%AD%E5%BB%BA%E5%90%8E%E5%8F%B0%E6%8E%A5%E5%8F%A3"><span class="toc-number">21.1.</span> <span class="toc-text">搭建后台接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#react%E8%84%9A%E6%89%8B%E6%9E%B6%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%90%86"><span class="toc-number">21.2.</span> <span class="toc-text">react脚手架配置代理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E9%80%9A%E8%AE%AF"><span class="toc-number">22.</span> <span class="toc-text">组件通讯</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#props"><span class="toc-number">22.1.</span> <span class="toc-text">props</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#context-%E4%BA%86%E8%A7%A3"><span class="toc-number">22.2.</span> <span class="toc-text">context  (了解)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%BB%98%E8%AE%A4%E5%80%BC%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">22.2.1.</span> <span class="toc-text">默认值的使用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pubsub"><span class="toc-number">22.3.</span> <span class="toc-text">pubsub</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Portals"><span class="toc-number">23.</span> <span class="toc-text">Portals</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fragment"><span class="toc-number">24.</span> <span class="toc-text">Fragment</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95DocumentFragment"><span class="toc-number">24.1.</span> <span class="toc-text">测试DocumentFragment</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E4%BD%BF%E7%94%A8React-Fragment"><span class="toc-number">24.2.</span> <span class="toc-text">不使用React.Fragment</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8React-Fragment"><span class="toc-number">24.3.</span> <span class="toc-text">使用React.Fragment</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E7%AE%80%E5%86%99-%E6%97%A0%E5%90%8D%E6%A0%87%E7%AD%BE-lt-gt"><span class="toc-number">24.4.</span> <span class="toc-text">使用简写(无名标签 &lt;&gt;)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DocumentFragment-%E4%BA%86%E8%A7%A3"><span class="toc-number">24.5.</span> <span class="toc-text">DocumentFragment (了解)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8F"><span class="toc-number">25.</span> <span class="toc-text">严格模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8F%E6%A3%80%E6%9F%A5%E7%9A%84%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">25.1.</span> <span class="toc-text">严格模式检查的是什么？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vue%E5%92%8Creact%E7%9A%84%E5%BC%82%E5%90%8C"><span class="toc-number">26.</span> <span class="toc-text">vue和react的异同</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#setState%E7%9A%84%E6%9B%B4%E5%A4%9A%E7%94%A8%E6%B3%95"><span class="toc-number">27.</span> <span class="toc-text">setState的更多用法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%AE%BE%E8%AE%A1%E6%88%90%E5%BC%82%E6%AD%A5"><span class="toc-number">27.1.</span> <span class="toc-text">为什么设计成异步</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#setState%E9%83%BD%E6%98%AF%E5%BC%82%E6%AD%A5%E7%9A%84%E5%90%97"><span class="toc-number">27.2.</span> <span class="toc-text">setState都是异步的吗</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="toc-number">28.</span> <span class="toc-text">性能优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SCU"><span class="toc-number">28.1.</span> <span class="toc-text">SCU</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PureComponent"><span class="toc-number">28.2.</span> <span class="toc-text">PureComponent</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#memo"><span class="toc-number">28.3.</span> <span class="toc-text">memo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shallowEqual%E6%96%B9%E6%B3%95"><span class="toc-number">28.4.</span> <span class="toc-text">shallowEqual方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E7%94%BB"><span class="toc-number">29.</span> <span class="toc-text">动画</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CSSTransition"><span class="toc-number">29.1.</span> <span class="toc-text">CSSTransition</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E5%B1%9E%E6%80%A7"><span class="toc-number">29.1.1.</span> <span class="toc-text">常见属性</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SwitchTransition"><span class="toc-number">29.2.</span> <span class="toc-text">SwitchTransition</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TransitionGroup"><span class="toc-number">29.3.</span> <span class="toc-text">TransitionGroup</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#React%E4%B8%AD%E7%9A%84CSS"><span class="toc-number">30.</span> <span class="toc-text">React中的CSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E8%81%94%E6%A0%B7%E5%BC%8F"><span class="toc-number">30.1.</span> <span class="toc-text">内联样式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%99%AE%E9%80%9A%E7%9A%84css"><span class="toc-number">30.2.</span> <span class="toc-text">普通的css</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#css-modules"><span class="toc-number">30.3.</span> <span class="toc-text">css modules</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#css-in-js"><span class="toc-number">30.4.</span> <span class="toc-text">css in js</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ES6%E6%A0%87%E7%AD%BE%E6%A8%A1%E6%9D%BF%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">30.4.1.</span> <span class="toc-text">ES6标签模板字符串</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#styled%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">30.4.2.</span> <span class="toc-text">styled的基本使用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E6%B7%BB%E5%8A%A0class"><span class="toc-number">30.5.</span> <span class="toc-text">动态添加class</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Redux%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7"><span class="toc-number">31.</span> <span class="toc-text">Redux状态管理工具</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8react%E4%B8%AD%E4%BD%BF%E7%94%A8redux"><span class="toc-number">31.1.</span> <span class="toc-text">在react中使用redux</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#redux%E4%B8%AD%E5%BC%82%E6%AD%A5%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="toc-number">31.2.</span> <span class="toc-text">redux中异步网络请求的操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#redux%E8%B0%83%E8%AF%95%E5%B7%A5%E5%85%B7"><span class="toc-number">31.3.</span> <span class="toc-text">redux调试工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#redux-toolkit"><span class="toc-number">31.4.</span> <span class="toc-text">redux-toolkit</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A4%E8%AF%86redux-toolkit"><span class="toc-number">31.4.1.</span> <span class="toc-text">认识redux-toolkit</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-1"><span class="toc-number">31.4.2.</span> <span class="toc-text">使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%82%E6%AD%A5%E6%93%8D%E4%BD%9C"><span class="toc-number">31.4.3.</span> <span class="toc-text">异步操作</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1"><span class="toc-number">32.</span> <span class="toc-text">路由</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-number">32.1.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">32.2.</span> <span class="toc-text">基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E6%98%A0%E5%B0%84%E9%85%8D%E7%BD%AE"><span class="toc-number">32.3.</span> <span class="toc-text">路由映射配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE%E5%92%8C%E8%B7%B3%E8%BD%AC"><span class="toc-number">32.4.</span> <span class="toc-text">路由配置和跳转</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NavLink%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">32.5.</span> <span class="toc-text">NavLink的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Navigate%E5%AF%BC%E8%88%AA"><span class="toc-number">32.6.</span> <span class="toc-text">Navigate导航</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Not-Found%E9%A1%B5%E9%9D%A2%E9%85%8D%E7%BD%AE"><span class="toc-number">32.7.</span> <span class="toc-text">Not Found页面配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E7%9A%84%E5%B5%8C%E5%A5%97"><span class="toc-number">32.8.</span> <span class="toc-text">路由的嵌套</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E8%B7%AF%E7%94%B1%E7%9A%84%E8%B7%B3%E8%BD%AC"><span class="toc-number">32.9.</span> <span class="toc-text">手动路由的跳转</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%8F%82%E6%95%B0%E8%B7%B3%E8%BD%AC"><span class="toc-number">32.10.</span> <span class="toc-text">路由参数跳转</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1"><span class="toc-number">32.10.1.</span> <span class="toc-text">动态路由</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#search%E4%BC%A0%E5%8F%82"><span class="toc-number">32.10.2.</span> <span class="toc-text">search传参</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">32.11.</span> <span class="toc-text">路由的配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useEffect-1"><span class="toc-number">32.12.</span> <span class="toc-text">useEffect</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B8%85%E9%99%A4%E5%89%AF%E4%BD%9C%E7%94%A8"><span class="toc-number">32.12.1.</span> <span class="toc-text">清除副作用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%B3%95-1"><span class="toc-number">32.12.2.</span> <span class="toc-text">用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E6%AC%A1%E4%BD%BF%E7%94%A8effect"><span class="toc-number">32.12.3.</span> <span class="toc-text">多次使用effect</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#effect%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="toc-number">32.12.4.</span> <span class="toc-text">effect性能优化</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useContext-1"><span class="toc-number">32.13.</span> <span class="toc-text">useContext</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useCallback"><span class="toc-number">32.14.</span> <span class="toc-text">useCallback</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useMemo"><span class="toc-number">32.15.</span> <span class="toc-text">useMemo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useRef-1"><span class="toc-number">32.16.</span> <span class="toc-text">useRef</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useImperativeHandle"><span class="toc-number">32.17.</span> <span class="toc-text">useImperativeHandle</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useLayoutEffect"><span class="toc-number">32.18.</span> <span class="toc-text">useLayoutEffect</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89hook"><span class="toc-number">32.19.</span> <span class="toc-text">自定义hook</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Mr.储</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://twikoo-api-ten-lac.vercel.app',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo-api-ten-lac.vercel.app',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>